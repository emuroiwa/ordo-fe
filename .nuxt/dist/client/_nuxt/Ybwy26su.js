import{_ as I}from"./B630Z1cd.js";import{E as J,A as G,L as K,r as y,j as p,k as Q,c as n,m as x,u as s,C as X,a as e,b as _,t as r,w,p as k,F as C,f as B,v as j,x as M,d as h,o as a}from"./B0BgVZwo.js";import{u as Y}from"./CLRd21rY.js";import{u as Z}from"./DoIc1ZKu.js";import{u as ee}from"./DBVts6qT.js";import{u as te}from"./Cfpi8IIo.js";import"./BdfSQn7-.js";const se={class:"min-h-screen bg-gray-50"},oe={key:0,class:"flex items-center justify-center min-h-screen"},le={key:1,class:"flex items-center justify-center min-h-screen"},ne={class:"text-center max-w-md mx-4"},ae={class:"text-sm text-gray-600 mb-4"},ie={key:2,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},re={class:"mb-8"},de={class:"flex mb-4 text-sm","aria-label":"Breadcrumb"},ue={class:"inline-flex items-center space-x-1 md:space-x-3"},ce={class:"inline-flex items-center"},me={class:"flex items-center"},ge={class:"flex items-center"},ve={class:"bg-white rounded-lg shadow-sm p-6 mb-6"},xe={class:"flex items-start space-x-4"},ye={class:"flex-shrink-0"},pe=["src","alt"],fe={key:1,class:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center"},be={class:"flex-1 min-w-0"},he={class:"text-2xl font-bold text-gray-900 mb-2"},_e={class:"text-gray-600 mb-2"},we={class:"flex items-center space-x-4 text-sm text-gray-500"},ke={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},De={class:"lg:col-span-2"},Se={class:"bg-white rounded-lg shadow-sm"},Ce={class:"p-6 border-b border-gray-200"},Be={class:"flex items-center justify-between"},je={class:"flex space-x-1 bg-gray-100 rounded-lg p-1"},Me={class:"flex items-center justify-between mt-4"},Le={class:"text-lg font-medium text-gray-900"},Ne={class:"p-6"},Ve={key:0,class:"space-y-4"},$e={class:"flex items-center justify-between mb-3"},ze={class:"flex items-center space-x-3"},Pe={class:"text-lg font-semibold text-gray-900"},Te={class:"text-sm text-gray-500"},Ae={key:0,class:"text-sm text-gray-400"},Ue={key:0,class:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2"},Fe=["onClick"],He={key:1,class:"grid grid-cols-7 gap-1"},Oe={key:2,class:"space-y-2"},Re={class:"lg:col-span-1"},qe={class:"bg-white rounded-lg shadow-sm p-6 sticky top-8"},Ee={class:"space-y-3 mb-6"},We={class:"flex justify-between"},Ie={class:"font-medium"},Je={class:"flex justify-between"},Ge={class:"font-medium"},Ke={class:"flex justify-between"},Qe={class:"font-medium"},Xe={key:0,class:"border-t border-gray-200 pt-4 mb-6"},Ye={class:"flex justify-between"},Ze={class:"text-right"},et={class:"font-medium"},tt={class:"text-sm text-gray-500"},st={key:1},ot={key:0,class:"space-y-4 mb-6"},lt=["disabled"],nt={key:0,class:"animate-spin h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24"},at={key:2,class:"text-center text-gray-500 text-sm"},xt=J({__name:"book",setup(it){const{fetchService:z,service:i,loading:P,error:L}=Y(),{isAuthenticated:D}=Z(),{createBooking:T}=ee(),A=G(),U=K(),d=y("week"),g=y(new Date),c=y(null),f=y(!1),u=y({email:"",phone:"",name:""}),F=y([{id:1,date:"2025-07-21",time:"09:00",available:!0},{id:2,date:"2025-07-21",time:"10:00",available:!0},{id:3,date:"2025-07-21",time:"11:00",available:!0},{id:4,date:"2025-07-22",time:"09:00",available:!0},{id:5,date:"2025-07-22",time:"14:00",available:!0},{id:6,date:"2025-07-22",time:"15:00",available:!0}]),N=p(()=>A.params.slug.slice(0,-1).join("/")),H=p(()=>{if(d.value==="week"){const o=$(g.value),t=new Date(o);return t.setDate(o.getDate()+6),`${o.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`}else return d.value==="month"?g.value.toLocaleDateString("en-US",{month:"long",year:"numeric"}):g.value.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})}),O=p(()=>{const o=$(g.value),t=[];for(let m=0;m<7;m++){const l=new Date(o);l.setDate(o.getDate()+m);const v=l.toISOString().split("T")[0],b=F.value.filter(S=>S.date===v&&S.available);t.push({date:v,dayName:l.toLocaleDateString("en-US",{weekday:"long"}),formatted:l.toLocaleDateString("en-US",{month:"short",day:"numeric"}),slots:b,hasSlots:b.length>0})}return t}),V=p(()=>c.value?D.value?!0:u.value.email&&u.value.phone&&u.value.name:!1),$=o=>{const t=new Date(o),m=t.getDay(),l=t.getDate()-m;return new Date(t.setDate(l))},R=()=>{const o=new Date(g.value);d.value==="week"?o.setDate(o.getDate()-7):d.value==="month"?o.setMonth(o.getMonth()-1):o.setDate(o.getDate()-1),g.value=o},q=()=>{const o=new Date(g.value);d.value==="week"?o.setDate(o.getDate()+7):d.value==="month"?o.setMonth(o.getMonth()+1):o.setDate(o.getDate()+1),g.value=o},E=o=>{c.value=o},W=async()=>{if(!(!V.value||!c.value)){f.value=!0;try{const o={service_id:i.value.id,scheduled_at:`${c.value.date}T${c.value.time}:00`,duration_minutes:i.value.duration_minutes,location_type:i.value.location_type,...D.value?{}:{guest_email:u.value.email,guest_phone:u.value.phone,guest_name:u.value.name}},t=await T(o);await U.push(`/booking/payment/${t.id}`)}catch(o){console.error("Failed to create booking:",o)}finally{f.value=!1}}};return te({title:p(()=>i.value?`Book ${i.value.title} - ORDO`:"Book Service - ORDO"),meta:[{name:"description",content:p(()=>{var o;return`Book ${((o=i.value)==null?void 0:o.title)||"service"} appointment online. Select your preferred date and time.`})}]}),Q(async()=>{try{await z(N.value)}catch(o){console.error("Failed to fetch service:",o)}}),(o,t)=>{const m=I;return a(),n("div",se,[s(P)?(a(),n("div",oe,t[6]||(t[6]=[X('<div class="text-center"><svg class="animate-spin h-12 w-12 text-blue-600 mx-auto mb-4" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><p class="text-gray-600">Loading booking calendar...</p></div>',1)]))):s(L)?(a(),n("div",le,[e("div",ne,[t[8]||(t[8]=e("div",{class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4"},[e("svg",{class:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),t[9]||(t[9]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Service Not Found",-1)),e("p",ae,r(s(L)),1),_(m,{to:"/services",class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"},{default:w(()=>t[7]||(t[7]=[h(" Browse Services ")])),_:1,__:[7]})])])):s(i)?(a(),n("div",ie,[e("div",re,[e("nav",de,[e("ol",ue,[e("li",ce,[_(m,{to:"/",class:"text-gray-500 hover:text-gray-700"},{default:w(()=>t[10]||(t[10]=[h("Home")])),_:1,__:[10]})]),e("li",null,[e("div",me,[t[12]||(t[12]=e("svg",{class:"w-4 h-4 text-gray-400 mx-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)),_(m,{to:"/services",class:"text-gray-500 hover:text-gray-700"},{default:w(()=>t[11]||(t[11]=[h("Services")])),_:1,__:[11]})])]),e("li",null,[e("div",ge,[t[13]||(t[13]=e("svg",{class:"w-4 h-4 text-gray-400 mx-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)),_(m,{to:`/services/${s(N)}`,class:"text-gray-500 hover:text-gray-700"},{default:w(()=>[h(r(s(i).title),1)]),_:1},8,["to"])])]),t[14]||(t[14]=e("li",null,[e("div",{class:"flex items-center"},[e("svg",{class:"w-4 h-4 text-gray-400 mx-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})]),e("span",{class:"text-gray-900 font-medium"},"Book Appointment")])],-1))])]),e("div",ve,[e("div",xe,[e("div",ye,[s(i).primary_image?(a(),n("img",{key:0,src:s(i).primary_image.url,alt:s(i).title,class:"w-16 h-16 rounded-lg object-cover"},null,8,pe)):(a(),n("div",fe,t[15]||(t[15]=[e("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])))]),e("div",be,[e("h1",he,r(s(i).title),1),e("p",_e,r(s(i).short_description),1),e("div",we,[e("span",null,r(s(i).formatted_price),1),e("span",null,r(s(i).duration_minutes)+" minutes",1),e("span",null,r(s(i).location_display),1)])])])])]),e("div",ke,[e("div",De,[e("div",Se,[e("div",Ce,[e("div",Be,[t[16]||(t[16]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Select Date & Time",-1)),e("div",je,[e("button",{onClick:t[0]||(t[0]=l=>d.value="week"),class:k(["px-3 py-1 text-sm font-medium rounded-md transition-colors",s(d)==="week"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"])}," Week ",2),e("button",{onClick:t[1]||(t[1]=l=>d.value="month"),class:k(["px-3 py-1 text-sm font-medium rounded-md transition-colors",s(d)==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"])}," Month ",2),e("button",{onClick:t[2]||(t[2]=l=>d.value="day"),class:k(["px-3 py-1 text-sm font-medium rounded-md transition-colors",s(d)==="day"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"])}," Day ",2)])]),e("div",Me,[e("button",{onClick:R,class:"p-2 hover:bg-gray-100 rounded-md transition-colors"},t[17]||(t[17]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),e("h3",Le,r(s(H)),1),e("button",{onClick:q,class:"p-2 hover:bg-gray-100 rounded-md transition-colors"},t[18]||(t[18]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))])]),e("div",Ne,[s(d)==="week"?(a(),n("div",Ve,[(a(!0),n(C,null,B(s(O),l=>(a(),n("div",{key:l.date,class:"border-b border-gray-100 pb-4 last:border-b-0"},[e("div",$e,[e("div",ze,[e("div",Pe,r(l.dayName),1),e("div",Te,r(l.formatted),1)]),l.hasSlots?x("",!0):(a(),n("div",Ae,"No availability"))]),l.hasSlots?(a(),n("div",Ue,[(a(!0),n(C,null,B(l.slots,v=>{var b;return a(),n("button",{key:v.time,onClick:S=>E(v),class:k(["px-3 py-2 text-sm font-medium rounded-md border transition-colors",((b=s(c))==null?void 0:b.id)===v.id?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-blue-50 hover:border-blue-300"])},r(v.time),11,Fe)}),128))])):x("",!0)]))),128))])):s(d)==="month"?(a(),n("div",He,[(a(),n(C,null,B(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],l=>e("div",{class:"text-center text-sm font-medium text-gray-500 py-2",key:l},r(l),1)),64)),t[19]||(t[19]=e("div",{class:"text-center text-sm text-gray-600 p-2"},"Month view coming soon...",-1))])):s(d)==="day"?(a(),n("div",Oe,t[20]||(t[20]=[e("div",{class:"text-center text-sm text-gray-600 p-8"},"Day view coming soon...",-1)]))):x("",!0)])])]),e("div",Re,[e("div",qe,[t[29]||(t[29]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Booking Summary",-1)),e("div",Ee,[e("div",We,[t[21]||(t[21]=e("span",{class:"text-gray-600"},"Service",-1)),e("span",Ie,r(s(i).title),1)]),e("div",Je,[t[22]||(t[22]=e("span",{class:"text-gray-600"},"Duration",-1)),e("span",Ge,r(s(i).duration_minutes)+" min",1)]),e("div",Ke,[t[23]||(t[23]=e("span",{class:"text-gray-600"},"Price",-1)),e("span",Qe,r(s(i).formatted_price),1)])]),s(c)?(a(),n("div",Xe,[e("div",Ye,[t[24]||(t[24]=e("span",{class:"text-gray-600"},"Date & Time",-1)),e("div",Ze,[e("div",et,r(s(c).date),1),e("div",tt,r(s(c).time),1)])])])):x("",!0),s(c)?(a(),n("div",st,[s(D)?x("",!0):(a(),n("div",ot,[e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email Address",-1)),j(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>s(u).email=l),type:"email",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"your@email.com"},null,512),[[M,s(u).email]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Phone Number",-1)),j(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>s(u).phone=l),type:"tel",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"+27 xxx xxx xxxx"},null,512),[[M,s(u).phone]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Full Name",-1)),j(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>s(u).name=l),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe"},null,512),[[M,s(u).name]])])])),e("button",{onClick:W,disabled:!s(V)||s(f),class:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center"},[s(f)?(a(),n("svg",nt,t[28]||(t[28]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):x("",!0),h(" "+r(s(f)?"Processing...":"Continue to Payment"),1)],8,lt)])):(a(),n("div",at," Select a time slot to continue "))])])])])):x("",!0)])}}});export{xt as default};
