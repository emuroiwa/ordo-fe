import{N as c,r as i,j as v}from"./B0BgVZwo.js";const T=()=>{const{$fetch:h}=c(),t=i(null),m=i(null),s=i(!1),f=i(!1),l=i(null),y=async()=>{var r;if(s.value)return t.value;s.value=!0,l.value=null;try{return t.value=await h("/api/v1/profile",{headers:{Accept:"application/json","Content-Type":"application/json"}}),t.value}catch(e){throw console.error("Profile fetch error:",e),l.value=((r=e.data)==null?void 0:r.message)||e.message||"Failed to fetch profile",e}finally{s.value=!1}},d=async r=>{var e;s.value=!0,l.value=null;try{const a=new FormData;Object.entries(r).forEach(([p,u])=>{u!=null&&(Array.isArray(u)?u.forEach((D,E)=>{a.append(`${p}[${E}]`,D)}):a.append(p,String(u)))});const{$fetch:n}=c(),o=await n("/api/v1/profile",{method:"PUT",body:a});return t.value=o.user,o}catch(a){throw l.value=((e=a.data)==null?void 0:e.message)||"Failed to update profile",a}finally{s.value=!1}},w=async r=>{var e;s.value=!0,l.value=null;try{const{$fetch:a}=c();return await a("/api/v1/profile/password",{method:"PUT",body:r})}catch(a){throw l.value=((e=a.data)==null?void 0:e.message)||"Failed to update password",a}finally{s.value=!1}},g=async r=>{var e;f.value=!0,l.value=null;try{const a=new FormData;a.append("avatar",r);const{$fetch:n}=c(),o=await n("/api/v1/profile/avatar",{method:"POST",body:a});return t.value&&(t.value.avatar_url=o.avatar_url),o}catch(a){throw l.value=((e=a.data)==null?void 0:e.message)||"Failed to upload avatar",a}finally{f.value=!1}},F=async()=>{var r;s.value=!0,l.value=null;try{const{$fetch:e}=c(),a=await e("/api/v1/profile/avatar",{method:"DELETE"});return t.value&&(t.value.avatar_url=a.avatar_url,t.value.avatar=void 0),a}catch(e){throw l.value=((r=e.data)==null?void 0:r.message)||"Failed to delete avatar",e}finally{s.value=!1}},_=async()=>{var r;try{return[]}catch(e){throw l.value=((r=e.data)==null?void 0:r.message)||"Failed to fetch profile stats",e}},$=async r=>{if(!t.value)return;const e=t.value.roles||["customer"];let a;return r==="vendor"?a=e.includes("vendor")?e:[...e,"vendor"]:(a=e.filter(n=>n!=="vendor"),a.includes("customer")||a.push("customer")),await d({roles:a})},b=v(()=>{if(!t.value)return!1;const r=["name","email"],e=t.value.is_vendor?["business_name","service_category"]:[];return[...r,...e].every(n=>{const o=t.value[n];return o!=null&&o!==""})}),P=v(()=>{if(!t.value)return 0;const r={name:!!t.value.name,email:!!t.value.email,phone:!!t.value.phone,business_name:!!t.value.business_name,service_category:!!t.value.service_category,avatar:!!t.value.avatar},e=Object.values(r).filter(Boolean).length,a=Object.keys(r).length;return Math.round(e/a*100)}),j=v(()=>t.value?t.value.business_name||t.value.name:""),A=v(()=>{var r;return(r=t.value)!=null&&r.name?t.value.name.split(" ").map(e=>e.charAt(0)).join("").toUpperCase().slice(0,2):"U"});return{user:t,stats:m,loading:s,uploading:f,error:l,isProfileComplete:b,profileCompletion:P,displayName:j,userInitials:A,fetchProfile:y,updateProfile:d,updatePassword:w,uploadAvatar:g,deleteAvatar:F,fetchStats:_,toggleRole:$}};export{T as u};
