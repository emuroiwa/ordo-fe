import{_ as Ue}from"./BssdN9D4.js";import{c as i,o as r,a as e,I as we,r as y,J as Be,E as fe,b as J,u as h,s as ke,m as D,F as P,f as I,v as A,t as d,z as Fe,B as se,d as V,K as ye,x as ne,j as Y,k as $e,G as he,g as ge,p as Z,C as Ve,w as Ne,n as Oe}from"./B0BgVZwo.js";import{u as Re}from"./BdfSQn7-.js";import{r as pe,e as je,d as Pe,c as Ie,b as Se,a as Ee}from"./BpPMJueg.js";import{u as ze}from"./CLRd21rY.js";import{u as _e}from"./DBVts6qT.js";import{u as He}from"./Cfpi8IIo.js";import{u as Je}from"./DoIc1ZKu.js";import{u as We}from"./CXAG8btk.js";function qe(Q,F){return r(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})])}function Ye(Q,F){return r(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})])}function Ge(Q,F){return r(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})])}function Ce(Q,F){return r(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}const ae=y([]),q=y(!1),W=y(null),Te=()=>{const Q=Be(),F=async(b,n={})=>{const o=Re("auth-token"),p={Accept:"application/json",...n.headers};return o.value&&(p.Authorization=`Bearer ${o.value}`),n.method!=="GET"&&!p["Content-Type"]&&(p["Content-Type"]="application/json"),await $fetch(b,{...n,baseURL:Q.public.apiBase,headers:p})},L=async(b={})=>{try{q.value=!0,W.value=null;const n=new URLSearchParams;b.date&&n.append("date",b.date),b.day_of_week&&n.append("day_of_week",b.day_of_week);const o=`/api/v1/availability${n.toString()?"?"+n.toString():""}`,p=await F(o);if(p.success)return ae.value=p.data,p.data;throw new Error(p.message||"Failed to fetch availabilities")}catch(n){throw W.value=n.message||"Failed to fetch availabilities",console.error("Fetch availabilities error:",n),n}finally{q.value=!1}},G=async b=>{try{q.value=!0,W.value=null;const n=await F("/api/v1/availability",{method:"POST",body:JSON.stringify(b)});if(n.success)return Array.isArray(n.data)?ae.value.push(...n.data):ae.value.push(n.data),n.data;throw new Error(n.message||"Failed to create availability")}catch(n){throw W.value=n.message||"Failed to create availability",console.error("Create availability error:",n),n}finally{q.value=!1}},S=async(b,n)=>{try{q.value=!0,W.value=null;const o=await F(`/api/v1/availability/${b}`,{method:"PUT",body:JSON.stringify(n)});if(o.success){const p=ae.value.findIndex(f=>f.id===b);return p!==-1&&(ae.value[p]=o.data),o.data}else throw new Error(o.message||"Failed to update availability")}catch(o){throw W.value=o.message||"Failed to update availability",console.error("Update availability error:",o),o}finally{q.value=!1}},U=async b=>{try{q.value=!0,W.value=null;const n=await F(`/api/v1/availability/${b}`,{method:"DELETE"});if(n.success)return ae.value=ae.value.filter(o=>o.id!==b),!0;throw new Error(n.message||"Failed to delete availability")}catch(n){throw W.value=n.message||"Failed to delete availability",console.error("Delete availability error:",n),n}finally{q.value=!1}},E=async(b,n)=>{try{q.value=!0,W.value=null;const o=new URLSearchParams({date:b});n&&o.append("service_id",n);const p=await F(`/api/v1/availability/time-slots?${o.toString()}`);if(p.success)return{slots:p.data,meta:p.meta};throw new Error(p.message||"Failed to get time slots")}catch(o){throw W.value=o.message||"Failed to get time slots",console.error("Get time slots error:",o),o}finally{q.value=!1}},$=async b=>{try{q.value=!0,W.value=null;const n=new URLSearchParams;b&&n.append("start_date",b);const o=`/api/v1/availability/weekly-overview${n.toString()?"?"+n.toString():""}`,p=await F(o);if(p.success)return{events:p.data,meta:p.meta};throw new Error(p.message||"Failed to get weekly overview")}catch(n){throw W.value=n.message||"Failed to get weekly overview",console.error("Get weekly overview error:",n),n}finally{q.value=!1}},g=async(b,n,o)=>{try{q.value=!0,W.value=null;const p=await F("/api/v1/availability/bulk-update",{method:"POST",body:JSON.stringify({availability_ids:b,action:n,data:o})});if(p.success)return await L(),p.data;throw new Error(p.message||"Failed to perform bulk update")}catch(p){throw W.value=p.message||"Failed to perform bulk update",console.error("Bulk update error:",p),p}finally{q.value=!1}},x=(b,n)=>{const o=new Date(b),p=o.toLocaleDateString("en-US",{weekday:"long"}).toLowerCase(),f=o.toISOString().split("T")[0];return!!(n||ae.value).find(j=>!(j.day_of_week!==p||!j.is_active||j.effective_from&&f<j.effective_from||j.effective_until&&f>j.effective_until))},k=(b,n)=>{const o=new Date(b),p=o.toLocaleDateString("en-US",{weekday:"long"}).toLowerCase(),f=o.toISOString().split("T")[0];return(n||ae.value).find(w=>!(w.day_of_week!==p||!w.is_active||w.effective_from&&f<w.effective_from||w.effective_until&&f>w.effective_until))},B=()=>{W.value=null};return{availabilities:we(ae),loading:we(q),error:we(W),fetchAvailabilities:L,createAvailability:G,updateAvailability:S,deleteAvailability:U,getTimeSlots:E,getWeeklyOverview:$,bulkUpdateAvailabilities:g,isDateAvailable:x,getAvailabilityForDate:k,clearError:B}},Ke={class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Ze={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white"},Qe={class:"flex items-center justify-between mb-6"},Xe={class:"mb-6"},et={class:"grid grid-cols-7 gap-2"},tt={class:"block text-xs text-gray-500 mb-1"},ot=["value"],st={class:"mb-6"},lt={class:"grid grid-cols-2 gap-4"},at=["value"],nt=["value"],rt={class:"mb-6"},it={class:"space-y-3"},dt=["onUpdate:modelValue"],ut=["value"],ct=["onUpdate:modelValue"],mt=["value"],vt=["onClick"],pt={class:"mb-6"},bt={class:"mb-6"},gt={class:"mb-6"},yt={class:"space-y-3"},ft={class:"flex items-center"},xt={class:"flex items-center"},wt={key:0,class:"mt-3 grid grid-cols-2 gap-4"},ht={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md"},kt={class:"text-sm text-red-700"},$t={class:"flex items-center justify-end space-x-3"},_t=["disabled"],Dt=["disabled"],St={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Ct=fe({__name:"AvailabilityModal",emits:["close","save"],setup(Q,{emit:F}){const L=F,{createAvailability:G,loading:S,error:U,clearError:E}=Te(),$=y(["monday","tuesday","wednesday","thursday","friday"]),g=y("09:00"),x=y("17:00"),k=y([{start:"12:00",end:"13:00"}]),B=y("60"),b=y("15"),n=y("ongoing"),o=y(""),p=y(""),f=y(""),R=[{value:"sunday",label:"Sun"},{value:"monday",label:"Mon"},{value:"tuesday",label:"Tue"},{value:"wednesday",label:"Wed"},{value:"thursday",label:"Thu"},{value:"friday",label:"Fri"},{value:"saturday",label:"Sat"}],w=Array.from({length:24*2},(z,c)=>{const l=Math.floor(c/2),t=c%2*30,M=`${l.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`,ie=new Date(`2000-01-01T${M}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return{value:M,label:ie}}),j=()=>{k.value.push({start:"12:00",end:"13:00"})},oe=z=>{k.value.splice(z,1)},re=async()=>{try{E(),f.value="";const z={working_days:$.value,working_hours:{start:g.value,end:x.value},break_times:k.value.filter(l=>l.start&&l.end),default_duration:parseInt(B.value),buffer_time:parseInt(b.value),apply_to:n.value,date_range:n.value==="dateRange"?{start:o.value,end:p.value}:void 0},c=await G(z);L("save",c),L("close")}catch(z){f.value=z.message||"Failed to save availability",console.error("Save availability error:",z)}},X=new Date;o.value=X.toISOString().split("T")[0];const de=new Date(X);return de.setMonth(X.getMonth()+1),p.value=de.toISOString().split("T")[0],(z,c)=>(r(),i("div",Ke,[e("div",Ze,[e("div",Qe,[c[11]||(c[11]=e("h3",{class:"text-lg font-medium text-gray-900"},"Set Availability",-1)),e("button",{onClick:c[0]||(c[0]=l=>L("close")),class:"text-gray-400 hover:text-gray-600 transition-colors"},[J(h(pe),{class:"w-6 h-6"})])]),e("form",{onSubmit:ke(re,["prevent"])},[e("div",Xe,[c[12]||(c[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"Working Days",-1)),e("div",et,[(r(),i(P,null,I(R,(l,t)=>e("div",{key:l.value,class:"text-center"},[e("label",tt,d(l.label),1),A(e("input",{"onUpdate:modelValue":c[1]||(c[1]=M=>$.value=M),value:l.value,type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"},null,8,ot),[[Fe,$.value]])])),64))])]),e("div",st,[c[15]||(c[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"Working Hours",-1)),e("div",lt,[e("div",null,[c[13]||(c[13]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Start Time",-1)),A(e("select",{"onUpdate:modelValue":c[2]||(c[2]=l=>g.value=l),class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[(r(!0),i(P,null,I(h(w),l=>(r(),i("option",{key:l.value,value:l.value},d(l.label),9,at))),128))],512),[[se,g.value]])]),e("div",null,[c[14]||(c[14]=e("label",{class:"block text-xs text-gray-500 mb-1"},"End Time",-1)),A(e("select",{"onUpdate:modelValue":c[3]||(c[3]=l=>x.value=l),class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[(r(!0),i(P,null,I(h(w),l=>(r(),i("option",{key:l.value,value:l.value},d(l.label),9,nt))),128))],512),[[se,x.value]])])])]),e("div",rt,[c[18]||(c[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"Break Times",-1)),e("div",it,[(r(!0),i(P,null,I(k.value,(l,t)=>(r(),i("div",{key:t,class:"flex items-center space-x-3"},[A(e("select",{"onUpdate:modelValue":M=>l.start=M,class:"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[(r(!0),i(P,null,I(h(w),M=>(r(),i("option",{key:M.value,value:M.value},d(M.label),9,ut))),128))],8,dt),[[se,l.start]]),c[16]||(c[16]=e("span",{class:"text-gray-500"},"to",-1)),A(e("select",{"onUpdate:modelValue":M=>l.end=M,class:"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[(r(!0),i(P,null,I(h(w),M=>(r(),i("option",{key:M.value,value:M.value},d(M.label),9,mt))),128))],8,ct),[[se,l.end]]),e("button",{type:"button",onClick:M=>oe(t),class:"text-red-600 hover:text-red-700"},[J(h(pe),{class:"w-5 h-5"})],8,vt)]))),128)),e("button",{type:"button",onClick:j,class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},[J(h(Ce),{class:"w-4 h-4 mr-2"}),c[17]||(c[17]=V(" Add Break Time "))])])]),e("div",pt,[c[20]||(c[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Default Appointment Duration",-1)),A(e("select",{"onUpdate:modelValue":c[4]||(c[4]=l=>B.value=l),class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},c[19]||(c[19]=[e("option",{value:"30"},"30 minutes",-1),e("option",{value:"60"},"1 hour",-1),e("option",{value:"90"},"1.5 hours",-1),e("option",{value:"120"},"2 hours",-1)]),512),[[se,B.value]])]),e("div",bt,[c[22]||(c[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Buffer Time Between Appointments",-1)),A(e("select",{"onUpdate:modelValue":c[5]||(c[5]=l=>b.value=l),class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},c[21]||(c[21]=[e("option",{value:"0"},"No buffer",-1),e("option",{value:"15"},"15 minutes",-1),e("option",{value:"30"},"30 minutes",-1),e("option",{value:"45"},"45 minutes",-1)]),512),[[se,b.value]])]),e("div",gt,[c[27]||(c[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"Apply Settings To",-1)),e("div",yt,[e("label",ft,[A(e("input",{"onUpdate:modelValue":c[6]||(c[6]=l=>n.value=l),value:"ongoing",type:"radio",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"},null,512),[[ye,n.value]]),c[23]||(c[23]=e("span",{class:"ml-2 text-sm text-gray-700"},"All future dates",-1))]),e("label",xt,[A(e("input",{"onUpdate:modelValue":c[7]||(c[7]=l=>n.value=l),value:"dateRange",type:"radio",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"},null,512),[[ye,n.value]]),c[24]||(c[24]=e("span",{class:"ml-2 text-sm text-gray-700"},"Specific date range",-1))])]),n.value==="dateRange"?(r(),i("div",wt,[e("div",null,[c[25]||(c[25]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Start Date",-1)),A(e("input",{"onUpdate:modelValue":c[8]||(c[8]=l=>o.value=l),type:"date",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[ne,o.value]])]),e("div",null,[c[26]||(c[26]=e("label",{class:"block text-xs text-gray-500 mb-1"},"End Date",-1)),A(e("input",{"onUpdate:modelValue":c[9]||(c[9]=l=>p.value=l),type:"date",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[ne,p.value]])])])):D("",!0)]),f.value||h(U)?(r(),i("div",ht,[e("p",kt,d(f.value||h(U)),1)])):D("",!0),e("div",$t,[e("button",{type:"button",onClick:c[10]||(c[10]=l=>L("close")),disabled:h(S),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Cancel ",8,_t),e("button",{type:"submit",disabled:h(S),class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center"},[h(S)?(r(),i("div",St)):D("",!0),V(" "+d(h(S)?"Saving...":"Save Availability"),1)],8,Dt)])],32)])]))}}),Tt={class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},At={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-2/3 lg:w-1/2 shadow-lg rounded-md bg-white"},Mt={class:"flex items-center justify-between mb-6"},Lt={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md"},Ut={class:"flex"},Bt={class:"ml-3"},Ft={class:"text-sm text-red-700"},Vt={key:1,class:"mb-4 p-3 bg-green-50 border border-green-200 rounded-md"},Nt={class:"flex"},Ot={class:"ml-3"},Rt={class:"text-sm text-green-700"},jt={class:"mb-6"},Pt={class:"relative"},It={key:0,class:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto"},Et=["onClick"],zt={class:"font-medium"},Ht={class:"text-sm text-gray-500"},Jt={key:0,class:"mt-2 p-3 bg-blue-50 rounded-md"},Wt={class:"flex items-center justify-between"},qt={class:"font-medium text-blue-900"},Yt={class:"text-sm text-blue-700"},Gt={class:"mb-6"},Kt=["value"],Zt={class:"mb-6"},Qt={class:"grid grid-cols-2 gap-4"},Xt=["min"],eo=["value"],to={class:"mb-6"},oo={class:"mb-6"},so={class:"space-y-2"},lo={class:"flex items-center"},ao={class:"flex items-center"},no={class:"flex items-center"},ro={key:2,class:"mb-6"},io={key:3,class:"mb-6"},uo={class:"mb-6"},co={key:4,class:"mb-6 p-4 bg-gray-50 rounded-lg"},mo={class:"space-y-1 text-sm text-gray-600"},vo={key:0},po={class:"flex items-center justify-end space-x-3"},bo=["disabled"],go={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},yo=fe({__name:"BookingModal",props:{selectedDate:{},selectedTime:{}},emits:["close","save"],setup(Q,{emit:F}){const L=Q,G=F,S=y(""),U=y([]),E=y(!1),$=y(null),g=y(""),x=y(""),k=y(""),B=y("60"),b=y("vendor_location"),n=y(""),o=y(""),p=y(""),f=y([]),R=y(!1),w=y(""),j=y(""),oe=Y(()=>f.value.find(_=>_.id===g.value)),re=Y(()=>new Date().toISOString().split("T")[0]),X=Y(()=>{const _=[];for(let s=8;s<=18;s++)for(let v=0;v<60;v+=30){const N=`${s.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`,le=new Date(`2000-01-01T${N}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});_.push({value:N,label:le})}return _}),de=Y(()=>{if(!x.value||!k.value)return"";const _=new Date(x.value),[s,v]=k.value.split(":");return _.setHours(parseInt(s),parseInt(v)),_.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}),z=Y(()=>{const _=$.value&&$.value.id,s=g.value&&g.value!=="",v=x.value&&x.value!=="",N=k.value&&k.value!=="",le=_&&s&&v&&N&&!R.value;return console.log("canSave computed:",{hasCustomer:_,hasService:s,hasDate:v,hasTime:N,isLoading:R.value,result:le}),le}),c=async()=>{if(S.value.length<2){E.value=!1;return}try{const _=[{id:"1",name:"John Doe",email:"john@example.com"},{id:"2",name:"Jane Smith",email:"jane@example.com"},{id:"3",name:"Bob Johnson",email:"bob@example.com"}];U.value=_.filter(s=>s.name.toLowerCase().includes(S.value.toLowerCase())||s.email.toLowerCase().includes(S.value.toLowerCase())),E.value=!0}catch(_){console.error("Failed to search customers:",_)}},l=_=>{$.value=_,S.value=_.name,E.value=!1},t=()=>{$.value=null,S.value=""},M=()=>{const _=oe.value;_&&_.duration&&(B.value=_.duration.toString())},ie=async()=>{try{K();const{fetchMyServices:_}=ze(),s=await _();s&&s.data?(f.value=s.data.map(v=>({id:v.id,title:v.title,price:v.base_price,duration:v.duration_minutes||60,description:v.description,currency:v.currency})),f.value.length===0&&(w.value="No services found. Please create a service first before scheduling appointments.")):(f.value=[],w.value="Failed to load services. Please try refreshing the page."),console.log("Loaded vendor services:",f.value)}catch(_){console.error("Failed to load services:",_),f.value=[],w.value="Unable to load services. Please check your internet connection and try again."}},K=()=>{w.value="",j.value=""},me=()=>(K(),!$.value||!$.value.id?(w.value="Please select a customer",!1):g.value?x.value?k.value?new Date(`${x.value}T${k.value}`)<new Date?(w.value="Appointment date and time cannot be in the past",!1):b.value==="customer_location"&&!n.value.trim()?(w.value="Customer address is required for customer location appointments",!1):b.value==="online"&&!o.value.trim()?(w.value="Meeting link is required for online appointments",!1):!0:(w.value="Please select an appointment time",!1):(w.value="Please select an appointment date",!1):(w.value="Please select a service",!1)),ue=async()=>{var _,s,v;if(console.log("handleSave called"),console.log("Form validation state:",{selectedCustomer:$.value,selectedServiceId:g.value,appointmentDate:x.value,appointmentTime:k.value,canSave:z.value}),!me()){console.log("Validation failed");return}console.log("Validation passed, proceeding with save"),R.value=!0,K();try{const N={customer_id:$.value.id,service_id:g.value,scheduled_at:new Date(`${x.value}T${k.value}`).toISOString(),duration_minutes:parseInt(B.value),location_type:b.value,customer_address:b.value==="customer_location"?n.value:null,meeting_link:b.value==="online"?o.value:null,vendor_notes:p.value,status:"confirmed"};console.log("Creating booking with data:",N);const{createBooking:le}=_e(),xe=await le(N);console.log("Booking created successfully:",xe),j.value="Appointment created successfully!",G("save",xe),setTimeout(()=>{G("close")},1500)}catch(N){console.error("Error creating appointment:",N),(s=(_=N.response)==null?void 0:_.data)!=null&&s.message?w.value=N.response.data.message:(v=N.data)!=null&&v.message?w.value=N.data.message:N.message?w.value=N.message:w.value="Failed to create appointment. Please try again."}finally{R.value=!1}},ve=()=>{$.value={id:"1",name:"John Doe",email:"john@example.com"},S.value="John Doe",E.value=!1},ce=()=>{f.value.length>0&&(g.value=f.value[0].id)};$e(()=>{ie(),L.selectedDate?x.value=L.selectedDate.toISOString().split("T")[0]:x.value=new Date().toISOString().split("T")[0],L.selectedTime&&(k.value=L.selectedTime),console.log("Modal initialized with:",{selectedDate:L.selectedDate,selectedTime:L.selectedTime,appointmentDate:x.value,appointmentTime:k.value})});const H=()=>{$.value=null,S.value="",E.value=!1,g.value="",k.value="",B.value="60",b.value="vendor_location",n.value="",o.value="",p.value="",K()};return he(S,_=>{_||(E.value=!1)}),he(()=>L,()=>{(L.selectedDate||L.selectedTime)&&H()},{immediate:!0}),(_,s)=>(r(),i("div",Tt,[e("div",At,[e("div",Mt,[s[13]||(s[13]=e("h3",{class:"text-lg font-medium text-gray-900"},"Create New Appointment",-1)),e("button",{onClick:s[0]||(s[0]=v=>G("close")),class:"text-gray-400 hover:text-gray-600 transition-colors"},[J(h(pe),{class:"w-6 h-6"})])]),e("form",{onSubmit:ke(ue,["prevent"])},[w.value?(r(),i("div",Lt,[e("div",Ut,[s[15]||(s[15]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("div",Bt,[e("p",Ft,d(w.value),1)]),e("div",{class:"ml-auto pl-3"},[e("button",{type:"button",onClick:K,class:"inline-flex text-red-400 hover:text-red-600"},s[14]||(s[14]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])])):D("",!0),j.value?(r(),i("div",Vt,[e("div",Nt,[s[17]||(s[17]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",Ot,[e("p",Rt,d(j.value),1)]),e("div",{class:"ml-auto pl-3"},[e("button",{type:"button",onClick:K,class:"inline-flex text-green-400 hover:text-green-600"},s[16]||(s[16]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])])):D("",!0),e("div",jt,[s[18]||(s[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Customer",-1)),e("div",Pt,[A(e("input",{"onUpdate:modelValue":s[1]||(s[1]=v=>S.value=v),onInput:c,type:"text",placeholder:"Search for customer by name or email...",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,544),[[ne,S.value]]),E.value&&U.value.length>0?(r(),i("div",It,[(r(!0),i(P,null,I(U.value,v=>(r(),i("div",{key:v.id,onClick:N=>l(v),class:"px-3 py-2 cursor-pointer hover:bg-gray-50"},[e("div",zt,d(v.name),1),e("div",Ht,d(v.email),1)],8,Et))),128))])):D("",!0)]),$.value?(r(),i("div",Jt,[e("div",Wt,[e("div",null,[e("div",qt,d($.value.name),1),e("div",Yt,d($.value.email),1)]),e("button",{type:"button",onClick:t,class:"text-blue-600 hover:text-blue-700"},[J(h(pe),{class:"w-5 h-5"})])])])):D("",!0)]),e("div",Gt,[s[20]||(s[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Service",-1)),A(e("select",{"onUpdate:modelValue":s[2]||(s[2]=v=>g.value=v),onChange:M,class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:""},[s[19]||(s[19]=e("option",{value:""},"Select a service",-1)),(r(!0),i(P,null,I(f.value,v=>(r(),i("option",{key:v.id,value:v.id},d(v.title)+" - "+d(v.currency||"R")+d(v.price),9,Kt))),128))],544),[[se,g.value]])]),e("div",{class:"mb-6 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},[s[21]||(s[21]=e("div",{class:"text-sm font-medium text-yellow-800 mb-2"},"Quick Select (for testing):",-1)),e("div",{class:"flex space-x-2"},[e("button",{type:"button",onClick:ve,class:"px-3 py-1 text-xs bg-yellow-100 text-yellow-800 border border-yellow-300 rounded hover:bg-yellow-200"}," Select John Doe "),e("button",{type:"button",onClick:ce,class:"px-3 py-1 text-xs bg-yellow-100 text-yellow-800 border border-yellow-300 rounded hover:bg-yellow-200"}," Select First Service ")])]),e("div",Zt,[e("div",Qt,[e("div",null,[s[22]||(s[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date",-1)),A(e("input",{"onUpdate:modelValue":s[3]||(s[3]=v=>x.value=v),type:"date",min:re.value,class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:""},null,8,Xt),[[ne,x.value]])]),e("div",null,[s[24]||(s[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Time",-1)),A(e("select",{"onUpdate:modelValue":s[4]||(s[4]=v=>k.value=v),class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:""},[s[23]||(s[23]=e("option",{value:""},"Select time",-1)),(r(!0),i(P,null,I(X.value,v=>(r(),i("option",{key:v.value,value:v.value},d(v.label),9,eo))),128))],512),[[se,k.value]])])])]),e("div",to,[s[26]||(s[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Duration",-1)),A(e("select",{"onUpdate:modelValue":s[5]||(s[5]=v=>B.value=v),class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},s[25]||(s[25]=[e("option",{value:"30"},"30 minutes",-1),e("option",{value:"60"},"1 hour",-1),e("option",{value:"90"},"1.5 hours",-1),e("option",{value:"120"},"2 hours",-1)]),512),[[se,B.value]])]),e("div",oo,[s[30]||(s[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Location",-1)),e("div",so,[e("label",lo,[A(e("input",{"onUpdate:modelValue":s[6]||(s[6]=v=>b.value=v),value:"vendor_location",type:"radio",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"},null,512),[[ye,b.value]]),s[27]||(s[27]=e("span",{class:"ml-2 text-sm text-gray-700"},"At my location",-1))]),e("label",ao,[A(e("input",{"onUpdate:modelValue":s[7]||(s[7]=v=>b.value=v),value:"customer_location",type:"radio",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"},null,512),[[ye,b.value]]),s[28]||(s[28]=e("span",{class:"ml-2 text-sm text-gray-700"},"At customer's location",-1))]),e("label",no,[A(e("input",{"onUpdate:modelValue":s[8]||(s[8]=v=>b.value=v),value:"online",type:"radio",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"},null,512),[[ye,b.value]]),s[29]||(s[29]=e("span",{class:"ml-2 text-sm text-gray-700"},"Online/Virtual",-1))])])]),b.value==="customer_location"?(r(),i("div",ro,[s[31]||(s[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Customer Address",-1)),A(e("textarea",{"onUpdate:modelValue":s[9]||(s[9]=v=>n.value=v),rows:"3",placeholder:"Enter customer's address...",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[ne,n.value]])])):D("",!0),b.value==="online"?(r(),i("div",io,[s[32]||(s[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Meeting Link",-1)),A(e("input",{"onUpdate:modelValue":s[10]||(s[10]=v=>o.value=v),type:"url",placeholder:"https://zoom.us/j/...",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[ne,o.value]])])):D("",!0),e("div",uo,[s[33]||(s[33]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notes",-1)),A(e("textarea",{"onUpdate:modelValue":s[11]||(s[11]=v=>p.value=v),rows:"3",placeholder:"Add any special instructions or notes for this appointment...",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[ne,p.value]])]),oe.value?(r(),i("div",co,[s[38]||(s[38]=e("h4",{class:"font-medium text-gray-900 mb-2"},"Appointment Summary",-1)),e("div",mo,[e("div",null,[s[34]||(s[34]=e("strong",null,"Service:",-1)),V(" "+d(oe.value.title),1)]),e("div",null,[s[35]||(s[35]=e("strong",null,"Duration:",-1)),V(" "+d(B.value)+" minutes",1)]),e("div",null,[s[36]||(s[36]=e("strong",null,"Price:",-1)),V(" R"+d(oe.value.price),1)]),x.value&&k.value?(r(),i("div",vo,[s[37]||(s[37]=e("strong",null,"Date & Time:",-1)),V(" "+d(de.value),1)])):D("",!0)])])):D("",!0),e("div",po,[e("button",{type:"button",onClick:s[12]||(s[12]=v=>G("close")),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"}," Cancel "),e("button",{type:"submit",disabled:!z.value,class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"},[R.value?(r(),i("svg",go,s[39]||(s[39]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):D("",!0),V(" "+d(R.value?"Creating...":"Create Appointment"),1)],8,bo)])],32)])]))}}),fo={class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},xo={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-2/3 lg:w-1/2 shadow-lg rounded-md bg-white"},wo={class:"mt-3"},ho={class:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200"},ko={class:"space-y-6"},$o={class:"bg-gray-50 rounded-lg p-4 mb-6"},_o={class:"text-sm text-gray-600"},Do={class:"space-y-6"},So={class:"grid grid-cols-2 gap-4"},Co=["min"],To=["value"],Ao={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Mo={class:"text-sm text-blue-800"},Lo={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},Uo={class:"flex"},Bo={class:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200"},Fo=["disabled"],Vo={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},No=fe({__name:"RescheduleModal",props:{booking:{}},emits:["close","reschedule"],setup(Q,{emit:F}){const L=Q,G=F,S=y(""),U=y(""),E=y(""),$=y(!1),g=Y(()=>{const n=new Date;return n.setDate(n.getDate()+1),n.toISOString().split("T")[0]}),x=Y(()=>{if(!S.value)return[];const n=[];for(let o=8;o<=18;o++)for(let p=0;p<60&&!(o===18&&p>0);p+=30){const f=`${o.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`,R=o>12?o-12:o===0?12:o,w=o>=12?"PM":"AM",j=p.toString().padStart(2,"0");n.push({value:f,label:`${R}:${j} ${w}`})}return n}),k=n=>new Date(n).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),B=()=>!S.value||!U.value?"":new Date(`${S.value}T${U.value}`).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),b=async()=>{if(!(!S.value||!U.value)){$.value=!0;try{const n=`${S.value}T${U.value}:00`;G("reschedule",L.booking,n)}finally{$.value=!1}}};return $e(()=>{const n=new Date;n.setDate(n.getDate()+1),S.value=n.toISOString().split("T")[0]}),(n,o)=>{var p;return r(),i("div",fo,[e("div",xo,[e("div",wo,[e("div",ho,[o[5]||(o[5]=e("h3",{class:"text-lg font-medium text-gray-900"}," Reschedule Booking ",-1)),e("button",{onClick:o[0]||(o[0]=f=>n.$emit("close")),class:"text-gray-400 hover:text-gray-600 transition-colors"},[J(h(pe),{class:"h-6 w-6"})])]),e("div",ko,[e("div",$o,[o[9]||(o[9]=e("h4",{class:"font-medium text-gray-900 mb-2"},"Current Booking",-1)),e("div",_o,[e("p",null,[o[6]||(o[6]=e("strong",null,"Service:",-1)),V(" "+d((p=n.booking.service)==null?void 0:p.title),1)]),e("p",null,[o[7]||(o[7]=e("strong",null,"Current Date:",-1)),V(" "+d(k(n.booking.scheduled_at)),1)]),e("p",null,[o[8]||(o[8]=e("strong",null,"Duration:",-1)),V(" "+d(n.booking.duration_minutes)+" minutes",1)])])]),e("div",Do,[e("div",So,[e("div",null,[o[10]||(o[10]=e("label",{for:"new-date",class:"block text-sm font-medium text-gray-700 mb-2"}," Select New Date ",-1)),A(e("input",{id:"new-date","onUpdate:modelValue":o[1]||(o[1]=f=>S.value=f),type:"date",min:g.value,class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,8,Co),[[ne,S.value]])]),e("div",null,[o[12]||(o[12]=e("label",{for:"new-time",class:"block text-sm font-medium text-gray-700 mb-2"}," Select New Time ",-1)),A(e("select",{id:"new-time","onUpdate:modelValue":o[2]||(o[2]=f=>U.value=f),class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[o[11]||(o[11]=e("option",{value:""},"Choose a time",-1)),(r(!0),i(P,null,I(x.value,f=>(r(),i("option",{key:f.value,value:f.value},d(f.label),9,To))),128))],512),[[se,U.value]])])]),e("div",null,[o[13]||(o[13]=e("label",{for:"reason",class:"block text-sm font-medium text-gray-700 mb-2"}," Reason for Rescheduling (Optional) ",-1)),A(e("textarea",{id:"reason","onUpdate:modelValue":o[3]||(o[3]=f=>E.value=f),rows:"3",placeholder:"Please provide a reason for rescheduling...",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[ne,E.value]])]),S.value&&U.value?(r(),i("div",Ao,[o[17]||(o[17]=e("h4",{class:"font-medium text-blue-900 mb-2"},"New Booking Details",-1)),e("div",Mo,[e("p",null,[o[14]||(o[14]=e("strong",null,"New Date:",-1)),V(" "+d(B()),1)]),e("p",null,[o[15]||(o[15]=e("strong",null,"Duration:",-1)),V(" "+d(n.booking.duration_minutes)+" minutes",1)]),o[16]||(o[16]=e("p",{class:"mt-2 text-xs text-blue-600"}," ⚠️ The service provider will need to confirm this new time slot. ",-1))])])):D("",!0),e("div",Lo,[e("div",Uo,[J(h(Ge),{class:"h-5 w-5 text-yellow-400"}),o[18]||(o[18]=e("div",{class:"ml-3"},[e("h3",{class:"text-sm font-medium text-yellow-800"}," Important Notice "),e("div",{class:"mt-2 text-sm text-yellow-700"},[e("ul",{class:"list-disc list-inside space-y-1"},[e("li",null,"Rescheduling must be done at least 24 hours before the original booking time"),e("li",null,"The service provider must approve the new time slot"),e("li",null,"You may be charged a rescheduling fee depending on the service terms")])])],-1))])])])]),e("div",Bo,[e("button",{onClick:o[4]||(o[4]=f=>n.$emit("close")),type:"button",class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"}," Cancel "),e("button",{onClick:b,disabled:!S.value||!U.value||$.value,type:"button",class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"},[$.value?(r(),i("svg",Vo,o[19]||(o[19]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):D("",!0),V(" "+d($.value?"Rescheduling...":"Reschedule Booking"),1)],8,Fo)])])])])}}}),Oo={class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Ro={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-2/3 lg:w-1/2 shadow-lg rounded-md bg-white"},jo={class:"flex items-center justify-between mb-6"},Po={class:"text-sm text-gray-500"},Io={class:"space-y-6"},Eo={class:"flex items-center justify-between"},zo={class:"flex items-center space-x-2"},Ho=["disabled"],Jo=["disabled"],Wo=["disabled"],qo={class:"bg-gray-50 rounded-lg p-4"},Yo={class:"grid grid-cols-2 gap-4"},Go={class:"font-medium"},Ko={key:0},Zo={class:"bg-gray-50 rounded-lg p-4"},Qo={class:"grid grid-cols-2 gap-4"},Xo={class:"font-medium"},es={class:"font-medium"},ts={key:0},os={class:"bg-gray-50 rounded-lg p-4"},ss={key:0},ls={key:1},as=["href"],ns={key:1},rs={class:"space-y-3"},is={key:0,class:"bg-blue-50 rounded-lg p-4"},ds={class:"text-blue-900"},us={key:1,class:"bg-purple-50 rounded-lg p-4"},cs={class:"text-purple-900"},ms={class:"bg-gray-50 rounded-lg p-4"},vs={class:"grid grid-cols-2 gap-4 text-sm"},ps={class:"font-mono"},bs={class:"font-medium"},gs={class:"flex items-center justify-between pt-4 border-t border-gray-200"},ys={class:"flex items-center space-x-3"},fs={class:"flex items-center space-x-3"},xs=["disabled"],ws={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},hs={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},ks={class:"mb-4"},$s={key:0,class:"mt-2 text-sm text-red-600"},_s={class:"flex items-center justify-end space-x-3"},Ds=["disabled"],Ss={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Cs=fe({__name:"AppointmentModal",props:{appointment:{}},emits:["close","update","delete"],setup(Q,{emit:F}){const{confirmBooking:L,markInProgress:G,completeBooking:S,updateBooking:U,cancelBooking:E,loading:$}=_e(),g=Q,x=F,k=y(g.appointment.vendor_notes||""),B=y(!1),b=y(!1),n=y(""),o=y(""),p=y(!1),f=Y(()=>new Date(g.appointment.scheduled_at).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})),R=l=>({pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",in_progress:"bg-purple-100 text-purple-800",completed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"})[l]||"bg-gray-100 text-gray-800",w=l=>({pending:"Pending",confirmed:"Confirmed",in_progress:"In Progress",completed:"Completed",cancelled:"Cancelled"})[l]||l,j=l=>({vendor_location:"Provider Location",customer_location:"Customer Location",online:"Online/Virtual"})[l]||l,oe=l=>new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),re=async l=>{try{let t;switch(l){case"confirmed":t=await L(g.appointment.id);break;case"in_progress":t=await G(g.appointment.id);break;case"completed":t=await S(g.appointment.id);break;default:t=await U(g.appointment.id,{status:l,vendor_notes:k.value})}x("update",t.booking||t)}catch(t){console.error("Failed to update appointment status:",t)}},X=async()=>{try{const l=await U(g.appointment.id,{vendor_notes:k.value});x("update",l.booking||l)}catch(l){console.error("Failed to save appointment changes:",l)}},de=()=>{o.value="",n.value="",b.value=!0},z=async()=>{var l;if(!n.value){o.value="Please select a cancellation reason";return}p.value=!0,o.value="";try{await E(g.appointment.id,n.value),b.value=!1,x("update",{...g.appointment,status:"cancelled"})}catch(t){console.error("Failed to cancel appointment:",t),o.value=((l=t.data)==null?void 0:l.message)||t.message||"Failed to cancel appointment. Please try again."}finally{p.value=!1}},c=l=>{const t={...g.appointment,scheduled_at:l};x("update",t),B.value=!1};return(l,t)=>{var M,ie,K,me,ue,ve,ce;return r(),i("div",Oo,[e("div",Ro,[e("div",jo,[e("div",null,[t[10]||(t[10]=e("h3",{class:"text-lg font-medium text-gray-900"},"Appointment Details",-1)),e("p",Po,d(f.value),1)]),e("button",{onClick:t[0]||(t[0]=H=>x("close")),class:"text-gray-400 hover:text-gray-600 transition-colors"},[J(h(pe),{class:"w-6 h-6"})])]),e("div",Io,[e("div",Eo,[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),e("span",{class:Z(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",R(l.appointment.status)])},d(w(l.appointment.status)),3)]),e("div",zo,[l.appointment.status==="pending"?(r(),i("button",{key:0,onClick:t[1]||(t[1]=H=>re("confirmed")),disabled:h($),class:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed"},[J(h(je),{class:"w-4 h-4 mr-1"}),V(" "+d(h($)?"Confirming...":"Confirm"),1)],8,Ho)):D("",!0),l.appointment.status==="confirmed"?(r(),i("button",{key:1,onClick:t[2]||(t[2]=H=>re("in_progress")),disabled:h($),class:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},[J(h(Pe),{class:"w-4 h-4 mr-1"}),V(" "+d(h($)?"Starting...":"Start"),1)],8,Jo)):D("",!0),l.appointment.status==="in_progress"?(r(),i("button",{key:2,onClick:t[3]||(t[3]=H=>re("completed")),disabled:h($),class:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-purple-600 hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed"},[J(h(Ie),{class:"w-4 h-4 mr-1"}),V(" "+d(h($)?"Completing...":"Complete"),1)],8,Wo)):D("",!0)])]),e("div",null,[t[16]||(t[16]=e("h4",{class:"text-sm font-medium text-gray-900 mb-3"},"Customer Information",-1)),e("div",qo,[e("div",Yo,[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Name",-1)),e("div",Go,d((M=l.appointment.customer)==null?void 0:M.name),1)]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Email",-1)),e("div",null,d((ie=l.appointment.customer)==null?void 0:ie.email),1)]),(K=l.appointment.customer)!=null&&K.phone?(r(),i("div",Ko,[t[14]||(t[14]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Phone",-1)),e("div",null,d((me=l.appointment.customer)==null?void 0:me.phone),1)])):D("",!0),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Customer Since",-1)),e("div",null,d(oe((ue=l.appointment.customer)==null?void 0:ue.created_at)),1)])])])]),e("div",null,[t[21]||(t[21]=e("h4",{class:"text-sm font-medium text-gray-900 mb-3"},"Service Information",-1)),e("div",Zo,[e("div",Qo,[e("div",null,[t[17]||(t[17]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Service",-1)),e("div",Xo,d((ve=l.appointment.service)==null?void 0:ve.title),1)]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Duration",-1)),e("div",null,d(l.appointment.duration)+" minutes",1)]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Price",-1)),e("div",es,"R"+d((ce=l.appointment.service)==null?void 0:ce.price),1)]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Location",-1)),e("div",null,d(j(l.appointment.location_type)),1)])])])]),l.appointment.customer_address||l.appointment.meeting_link?(r(),i("div",ts,[t[24]||(t[24]=e("h4",{class:"text-sm font-medium text-gray-900 mb-3"},"Location Details",-1)),e("div",os,[l.appointment.customer_address?(r(),i("div",ss,[t[22]||(t[22]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Customer Address",-1)),e("div",null,d(l.appointment.customer_address),1)])):D("",!0),l.appointment.meeting_link?(r(),i("div",ls,[t[23]||(t[23]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Meeting Link",-1)),e("a",{href:l.appointment.meeting_link,target:"_blank",class:"text-blue-600 hover:text-blue-700 underline"},d(l.appointment.meeting_link),9,as)])):D("",!0)])])):D("",!0),l.appointment.customer_notes||l.appointment.vendor_notes?(r(),i("div",ns,[t[27]||(t[27]=e("h4",{class:"text-sm font-medium text-gray-900 mb-3"},"Notes",-1)),e("div",rs,[l.appointment.customer_notes?(r(),i("div",is,[t[25]||(t[25]=e("label",{class:"block text-xs text-blue-700 mb-1"},"Customer Notes",-1)),e("div",ds,d(l.appointment.customer_notes),1)])):D("",!0),l.appointment.vendor_notes?(r(),i("div",us,[t[26]||(t[26]=e("label",{class:"block text-xs text-purple-700 mb-1"},"Your Notes",-1)),e("div",cs,d(l.appointment.vendor_notes),1)])):D("",!0)])])):D("",!0),e("div",null,[t[28]||(t[28]=e("h4",{class:"text-sm font-medium text-gray-900 mb-3"},"Add/Edit Notes",-1)),A(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=H=>k.value=H),rows:"3",placeholder:"Add notes about this appointment...",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[ne,k.value]])]),e("div",null,[t[33]||(t[33]=e("h4",{class:"text-sm font-medium text-gray-900 mb-3"},"Booking Details",-1)),e("div",ms,[e("div",vs,[e("div",null,[t[29]||(t[29]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Booking Reference",-1)),e("div",ps,d(l.appointment.booking_reference),1)]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Created",-1)),e("div",null,d(oe(l.appointment.created_at)),1)]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Total Amount",-1)),e("div",bs,"R"+d(l.appointment.total_amount),1)]),e("div",null,[t[32]||(t[32]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Payment Status",-1)),e("span",{class:Z(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",l.appointment.payment_status==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"])},d(l.appointment.payment_status||"pending"),3)])])])]),e("div",gs,[e("div",ys,[e("button",{onClick:t[5]||(t[5]=H=>B.value=!0),class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},[J(h(Se),{class:"w-4 h-4 mr-2"}),t[34]||(t[34]=V(" Reschedule "))]),e("button",{onClick:de,class:"inline-flex items-center px-3 py-2 border border-red-300 shadow-sm text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50"},[J(h(pe),{class:"w-4 h-4 mr-2"}),t[35]||(t[35]=V(" Cancel Appointment "))])]),e("div",fs,[e("button",{onClick:t[6]||(t[6]=H=>x("close")),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"}," Close "),e("button",{onClick:X,disabled:h($),class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},d(h($)?"Saving...":"Save Changes"),9,xs)])])]),B.value?(r(),ge(No,{key:0,booking:l.appointment,onClose:t[7]||(t[7]=H=>B.value=!1),onReschedule:c},null,8,["booking"])):D("",!0),b.value?(r(),i("div",ws,[e("div",hs,[t[38]||(t[38]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Cancel Appointment",-1)),t[39]||(t[39]=e("p",{class:"text-gray-600 mb-4"},"Are you sure you want to cancel this appointment? This action cannot be undone.",-1)),e("div",ks,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cancellation Reason",-1)),A(e("select",{"onUpdate:modelValue":t[8]||(t[8]=H=>n.value=H),class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},t[36]||(t[36]=[Ve('<option value="">Select a reason</option><option value="provider_unavailable">Provider unavailable</option><option value="emergency">Emergency</option><option value="customer_request">Customer requested</option><option value="weather">Weather conditions</option><option value="other">Other</option>',6)]),512),[[se,n.value]]),o.value?(r(),i("div",$s,d(o.value),1)):D("",!0)]),e("div",_s,[e("button",{onClick:t[9]||(t[9]=H=>b.value=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"}," Keep Appointment "),e("button",{onClick:z,disabled:p.value,class:"px-4 py-2 bg-red-600 text-white rounded-md text-sm font-medium hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center"},[p.value?(r(),i("div",Ss)):D("",!0),V(" "+d(p.value?"Cancelling...":"Cancel Appointment"),1)],8,Ds)])])])):D("",!0)])])}}}),Ts={class:"mb-6"},As={class:"flex items-center justify-between"},Ms={class:"flex items-center space-x-4"},Ls={class:"bg-gray-100 p-1 rounded-lg flex"},Us={class:"bg-white rounded-lg shadow mb-6 p-4"},Bs={class:"flex items-center justify-between"},Fs={class:"flex items-center space-x-4"},Vs={class:"text-lg font-semibold text-gray-900"},Ns={class:"bg-white rounded-lg shadow"},Os={key:0,class:"p-6"},Rs={class:"grid grid-cols-7 gap-1 mb-4"},js={class:"grid grid-cols-7 gap-1"},Ps=["onClick"],Is={class:"flex items-center justify-between mb-1"},Es={key:0,class:"w-2 h-2 bg-green-400 rounded-full",title:"Available"},zs={class:"space-y-1"},Hs=["onClick","title"],Js={key:1,class:"p-6"},Ws={class:"grid grid-cols-8 gap-1"},qs={class:"space-y-1"},Ys={class:"text-xs text-gray-500"},Gs={class:"relative"},Ks=["onClick"],Zs=["onClick"],Qs={class:"font-medium"},Xs={key:2,class:"p-6"},el={class:"grid grid-cols-2 gap-6"},tl={class:"text-lg font-medium text-gray-900 mb-4"},ol={class:"space-y-1"},sl=["onClick"],ll={class:"font-medium"},al={key:0,class:"flex items-center space-x-2"},nl={class:"text-sm text-gray-600"},rl={key:1,class:"text-sm text-green-600"},il={key:2,class:"text-sm text-gray-500"},dl={class:"space-y-4"},ul={class:"grid grid-cols-2 gap-4"},cl={class:"bg-blue-50 p-4 rounded-lg"},ml={class:"text-2xl font-bold text-blue-600"},vl={class:"bg-green-50 p-4 rounded-lg"},pl={class:"text-2xl font-bold text-green-600"},bl={key:0},gl={class:"space-y-2"},yl=["onClick"],fl={class:"flex items-center justify-between"},xl={class:"font-medium"},wl={class:"text-sm text-gray-600"},hl={class:"text-sm text-gray-500"},kl={key:1,class:"text-center py-8 text-gray-500"},Ul=fe({__name:"calendar",setup(Q){He({title:"Calendar - ORDO Dashboard",meta:[{name:"description",content:"Manage your appointments and availability"}]}),Je(),We();const{bookings:F,fetchBookings:L,updateBooking:G,cancelBooking:S}=_e(),{availabilities:U,fetchAvailabilities:E,isDateAvailable:$}=Te(),g=y("month"),x=y(new Date),k=y(null),B=y(null),b=y(null),n=y(!1),o=y(!1),p=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],f=["January","February","March","April","May","June","July","August","September","October","November","December"],R={start:8,end:18},w=Array.from({length:R.end-R.start},(m,a)=>R.start+a),j=Y(()=>{const m=x.value.getFullYear(),a=x.value.getMonth();if(g.value==="month")return`${f[a]} ${m}`;if(g.value==="week"){const T=ie(x.value),u=new Date(T);return u.setDate(T.getDate()+6),T.getMonth()===u.getMonth()?`${f[T.getMonth()]} ${T.getDate()}-${u.getDate()}, ${m}`:`${f[T.getMonth()]} ${T.getDate()} - ${f[u.getMonth()]} ${u.getDate()}, ${m}`}else{const T=x.value.getDate();return`${f[a]} ${T}, ${m}`}}),oe=Y(()=>{const m=x.value.getFullYear(),a=x.value.getMonth(),T=new Date(m,a,1),u=new Date(T);u.setDate(u.getDate()-T.getDay());const C=[],O=new Date;for(let ee=0;ee<42;ee++){const te=new Date(u);te.setDate(u.getDate()+ee);const De={date:te.getDate(),fullDate:new Date(te),isCurrentMonth:te.getMonth()===a,isToday:K(te,O),isSelected:k.value&&K(te,k.value),isAvailable:me(te),appointments:ue(te)};C.push(De)}return C}),re=Y(()=>{const m=ie(x.value),a=[],T=new Date;for(let u=0;u<7;u++){const C=new Date(m);C.setDate(m.getDate()+u),a.push({date:C.getDate(),fullDate:new Date(C),dayName:p[C.getDay()],isToday:K(C,T),appointments:ue(C)})}return a}),X=Y(()=>k.value||x.value),de=Y(()=>{const m=X.value;return`${f[m.getMonth()]} ${m.getDate()}, ${m.getFullYear()}`}),z=Y(()=>ue(X.value)),c=Y(()=>{const m=z.value,a=w.length,T=m.length;return{totalAppointments:m.length,availableSlots:a-T}}),l=m=>{const a=new Date(x.value);g.value==="month"?a.setMonth(a.getMonth()+(m==="next"?1:-1)):g.value==="week"?a.setDate(a.getDate()+(m==="next"?7:-7)):a.setDate(a.getDate()+(m==="next"?1:-1)),x.value=a},t=()=>{x.value=new Date,k.value=new Date},M=m=>{k.value=m.fullDate,g.value==="month"&&(g.value="day")},ie=m=>{const a=new Date(m);return a.setDate(m.getDate()-m.getDay()),a},K=(m,a)=>m.getDate()===a.getDate()&&m.getMonth()===a.getMonth()&&m.getFullYear()===a.getFullYear(),me=m=>{const a=new Date;return a.setHours(0,0,0,0),m<a?!1:$(m,U.value)},ue=m=>F.value.filter(a=>{const T=new Date(a.scheduled_at);return K(T,m)}).map(a=>({id:a.id,time:ve(new Date(a.scheduled_at)),duration:a.duration_minutes,status:a.status,customer:a.customer,service:a.service,scheduled_at:a.scheduled_at})),ve=m=>m.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),ce=m=>{const a=new Date;return a.setHours(m,0,0,0),ve(a)},H=m=>({pending:"bg-yellow-100 text-yellow-800 border-yellow-200",confirmed:"bg-blue-100 text-blue-800 border-blue-200",in_progress:"bg-purple-100 text-purple-800 border-purple-200",completed:"bg-green-100 text-green-800 border-green-200",cancelled:"bg-red-100 text-red-800 border-red-200"})[m]||"bg-gray-100 text-gray-800 border-gray-200",_=m=>{const a=new Date(m.scheduled_at),T=a.getHours(),u=a.getMinutes(),C=m.duration||60,O=(T-R.start)*64+u*64/60,ee=C*64/60;return{top:`${O}px`,height:`${ee}px`}},s=m=>!v(m)&&me(X.value),v=m=>z.value.find(a=>new Date(a.scheduled_at).getHours()===m),N=(m,a)=>{const T=new Date(m.fullDate||m);T.setHours(a,0,0,0),k.value=T,B.value=ce(a),o.value=!0},le=m=>{b.value=m},xe=async m=>{await be(),n.value=!1},Ae=async m=>{try{console.log("handleBookingSave called with:",m),await be()}catch(a){console.error("Failed to refresh calendar after booking creation:",a)}},Me=async m=>{try{await G(m.id,m),await be(),b.value=null}catch(a){console.error("Failed to update appointment:",a)}},Le=async(m,a)=>{try{await S(m,a||"Cancelled by provider"),await be(),b.value=null}catch(T){console.error("Failed to cancel appointment:",T)}},be=async()=>{try{const m=new Date(x.value);m.setDate(1);const a=new Date(x.value);a.setMonth(a.getMonth()+1,0),await Promise.all([L({type:"vendor",start_date:m.toISOString().split("T")[0],end_date:a.toISOString().split("T")[0],per_page:100}),E({})])}catch(m){console.error("Failed to load calendar data:",m)}};return he([x,g],()=>{be()}),$e(()=>{k.value=new Date,be()}),(m,a)=>{const T=Ue;return r(),ge(T,{name:"dashboard"},{default:Ne(()=>[e("div",null,[e("div",Ts,[e("div",As,[a[12]||(a[12]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Calendar"),e("p",{class:"text-gray-600"},"Manage your appointments and availability")],-1)),e("div",Ms,[e("div",Ls,[e("button",{onClick:a[0]||(a[0]=u=>g.value="month"),class:Z(["px-3 py-1 text-sm font-medium rounded-md transition-colors",g.value==="month"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"])}," Month ",2),e("button",{onClick:a[1]||(a[1]=u=>g.value="week"),class:Z(["px-3 py-1 text-sm font-medium rounded-md transition-colors",g.value==="week"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"])}," Week ",2),e("button",{onClick:a[2]||(a[2]=u=>g.value="day"),class:Z(["px-3 py-1 text-sm font-medium rounded-md transition-colors",g.value==="day"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"])}," Day ",2)]),e("button",{onClick:a[3]||(a[3]=u=>n.value=!0),class:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[J(h(Se),{class:"w-4 h-4 mr-2"}),a[10]||(a[10]=V(" Set Availability "))]),e("button",{onClick:a[4]||(a[4]=u=>o.value=!0),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[J(h(Ce),{class:"w-4 h-4 mr-2"}),a[11]||(a[11]=V(" New Appointment "))])])])]),e("div",Us,[e("div",Bs,[e("div",Fs,[e("button",{onClick:a[5]||(a[5]=u=>l("prev")),class:"p-2 text-gray-400 hover:text-gray-600 transition-colors"},[J(h(qe),{class:"w-5 h-5"})]),e("h2",Vs,d(j.value),1),e("button",{onClick:a[6]||(a[6]=u=>l("next")),class:"p-2 text-gray-400 hover:text-gray-600 transition-colors"},[J(h(Ye),{class:"w-5 h-5"})])]),e("button",{onClick:t,class:"px-3 py-1 text-sm text-blue-600 hover:text-blue-700 font-medium"}," Today ")])]),e("div",Ns,[g.value==="month"?(r(),i("div",Os,[e("div",Rs,[(r(),i(P,null,I(p,u=>e("div",{key:u,class:"p-2 text-center text-sm font-medium text-gray-500"},d(u),1)),64))]),e("div",js,[(r(!0),i(P,null,I(oe.value,(u,C)=>(r(),i("div",{key:`${u.date}-${C}`,class:Z(["min-h-[120px] p-2 border border-gray-100 cursor-pointer transition-colors",u.isCurrentMonth?"bg-white hover:bg-gray-50":"bg-gray-50 text-gray-400",u.isToday?"bg-blue-50 border-blue-200":"",u.isSelected?"bg-blue-100 border-blue-300":""]),onClick:O=>M(u)},[e("div",Is,[e("span",{class:Z(["text-sm font-medium",u.isToday?"text-blue-600":"",u.isCurrentMonth?"text-gray-900":"text-gray-400"])},d(u.date),3),u.isAvailable&&u.isCurrentMonth?(r(),i("div",Es)):D("",!0)]),e("div",zs,[(r(!0),i(P,null,I(u.appointments,O=>{var ee,te;return r(),i("div",{key:O.id,class:Z(["text-xs p-1 rounded truncate cursor-pointer",H(O.status)]),onClick:ke(De=>le(O),["stop"]),title:`${O.time} - ${(ee=O.service)==null?void 0:ee.title}`},d(O.time)+" "+d((te=O.customer)==null?void 0:te.name),11,Hs)}),128))])],10,Ps))),128))])])):g.value==="week"?(r(),i("div",Js,[e("div",Ws,[e("div",qs,[a[13]||(a[13]=e("div",{class:"h-12"},null,-1)),(r(!0),i(P,null,I(h(w),u=>(r(),i("div",{key:u,class:"h-16 text-xs text-gray-500 pr-2 text-right"},d(ce(u)),1))),128))]),(r(!0),i(P,null,I(re.value,u=>(r(),i("div",{key:u.date,class:"border-l border-gray-200"},[e("div",{class:Z(["h-12 p-2 text-center border-b border-gray-200",u.isToday?"bg-blue-50":"bg-gray-50"])},[e("div",Ys,d(u.dayName),1),e("div",{class:Z(["text-sm font-medium",u.isToday?"text-blue-600":"text-gray-900"])},d(u.date),3)],2),e("div",Gs,[(r(!0),i(P,null,I(h(w),C=>(r(),i("div",{key:C,class:"h-16 border-b border-gray-100",onClick:O=>N(u,C)},null,8,Ks))),128)),(r(!0),i(P,null,I(u.appointments,C=>{var O,ee;return r(),i("div",{key:C.id,class:Z(["absolute left-1 right-1 p-1 rounded text-xs cursor-pointer z-10",H(C.status)]),style:Oe(_(C)),onClick:te=>le(C)},[e("div",Qs,d((O=C.customer)==null?void 0:O.name),1),e("div",null,d((ee=C.service)==null?void 0:ee.title),1)],14,Zs)}),128))])]))),128))])])):g.value==="day"?(r(),i("div",Xs,[e("div",el,[e("div",null,[e("h3",tl,d(de.value),1),e("div",ol,[(r(!0),i(P,null,I(h(w),u=>{var C;return r(),i("div",{key:u,class:Z(["flex items-center justify-between p-3 border border-gray-200 rounded-lg cursor-pointer transition-colors",s(u)?"hover:bg-gray-50":"bg-gray-100 cursor-not-allowed"]),onClick:O=>s(u)&&N(X.value,u)},[e("span",ll,d(ce(u)),1),v(u)?(r(),i("div",al,[e("span",{class:Z(["px-2 py-1 rounded text-xs",H(v(u).status)])},d(v(u).status),3),e("span",nl,d((C=v(u).customer)==null?void 0:C.name),1)])):s(u)?(r(),i("div",rl," Available ")):(r(),i("div",il," Unavailable "))],10,sl)}),128))])]),e("div",null,[a[18]||(a[18]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Day Summary",-1)),e("div",dl,[e("div",ul,[e("div",cl,[e("div",ml,d(c.value.totalAppointments),1),a[14]||(a[14]=e("div",{class:"text-sm text-blue-600"},"Appointments",-1))]),e("div",vl,[e("div",pl,d(c.value.availableSlots),1),a[15]||(a[15]=e("div",{class:"text-sm text-green-600"},"Available Slots",-1))])]),z.value.length>0?(r(),i("div",bl,[a[16]||(a[16]=e("h4",{class:"font-medium text-gray-900 mb-2"},"Today's Appointments",-1)),e("div",gl,[(r(!0),i(P,null,I(z.value,u=>{var C,O;return r(),i("div",{key:u.id,class:"p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",onClick:ee=>le(u)},[e("div",fl,[e("div",null,[e("div",xl,d(u.time),1),e("div",wl,d((C=u.customer)==null?void 0:C.name),1),e("div",hl,d((O=u.service)==null?void 0:O.title),1)]),e("span",{class:Z(["px-2 py-1 rounded text-xs",H(u.status)])},d(u.status),3)])],8,yl)}),128))])])):(r(),i("div",kl,[J(h(Ee),{class:"w-12 h-12 mx-auto mb-2 text-gray-300"}),a[17]||(a[17]=e("p",null,"No appointments scheduled for this day",-1))]))])])])])):D("",!0)]),n.value?(r(),ge(Ct,{key:0,onClose:a[7]||(a[7]=u=>n.value=!1),onSave:xe})):D("",!0),o.value?(r(),ge(yo,{key:1,"selected-date":k.value,"selected-time":B.value,onClose:a[8]||(a[8]=u=>o.value=!1),onSave:Ae},null,8,["selected-date","selected-time"])):D("",!0),b.value?(r(),ge(Cs,{key:2,appointment:b.value,onClose:a[9]||(a[9]=u=>b.value=null),onUpdate:Me,onDelete:Le},null,8,["appointment"])):D("",!0)])]),_:1})}}});export{Ul as default};
