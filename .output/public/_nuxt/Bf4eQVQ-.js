import{_ as De}from"./B630Z1cd.js";import{r as L,a as se,b as oe,c as ne,d as fe,e as be}from"./BpPMJueg.js";import{c as a,o as l,a as e,E as xe,j as B,b as c,u as d,m as u,t as n,p as N,F as A,d as p,r as C,G as Me,k as Se,H as ce,g as G,w as me,v as te,B as ge,x as Re,f as Pe}from"./B0BgVZwo.js";import{_ as je}from"./BssdN9D4.js";import{u as Te}from"./DoIc1ZKu.js";import{u as Fe}from"./CXAG8btk.js";import{u as Le}from"./DBVts6qT.js";import{u as Ne}from"./Cfpi8IIo.js";import"./BdfSQn7-.js";function Ae(_,f){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function Ve(_,f){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}function Ze(_,f){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})])}function pe(_,f){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"})])}function ve(_,f){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})])}const Ue={class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ze={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white"},Ye={class:"mt-3"},Ee={class:"flex items-center justify-between pb-4 border-b border-gray-200"},Ie={class:"mt-6 space-y-6"},Oe={class:"bg-gray-50 rounded-lg p-4"},He={class:"flex items-center justify-between mb-4"},qe={class:"text-lg font-medium text-gray-900"},Ge={class:"grid grid-cols-2 gap-4 text-sm"},Qe={class:"font-medium"},We={class:"font-medium"},Je={class:"font-medium capitalize"},Ke={class:"font-medium"},Xe={class:"bg-blue-50 rounded-lg p-4"},et={class:"flex items-center space-x-3"},tt={class:"font-medium text-gray-900"},st={class:"text-sm text-gray-600"},ot={class:"mt-3 flex items-center space-x-3"},nt={class:"text-sm text-gray-700"},rt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},it={class:"border rounded-lg p-4"},lt={class:"flex items-center space-x-3"},at={class:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center"},dt={class:"font-medium"},ut={class:"text-sm text-gray-500"},ct={class:"border rounded-lg p-4"},mt={class:"flex items-center space-x-3"},gt={class:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center"},pt={class:"font-medium"},vt={class:"text-sm text-gray-500"},ft={key:0},bt={class:"border rounded-lg p-4"},xt={class:"font-medium text-gray-900"},yt={class:"text-sm text-gray-600 mt-1"},ht={class:"mt-3 flex items-center space-x-4 text-sm text-gray-500"},wt={key:1},_t={class:"space-y-3"},kt={key:0,class:"bg-yellow-50 border border-yellow-200 rounded-lg p-3"},$t={class:"text-sm text-yellow-700 mt-1"},Ct={key:1,class:"bg-blue-50 border border-blue-200 rounded-lg p-3"},Bt={class:"text-sm text-blue-700 mt-1"},Dt={key:2},Mt={class:"bg-gray-50 rounded-lg p-4"},St={class:"flex items-start space-x-3"},Rt={class:"text-sm text-gray-900"},Pt={key:0,class:"text-sm text-gray-900"},jt={class:"text-sm text-gray-600"},Tt={class:"bg-gray-50 rounded-lg p-4"},Ft={class:"grid grid-cols-2 gap-4 text-sm"},Lt={class:"font-medium"},Nt={class:"font-medium"},At={class:"font-medium"},Vt={class:"mt-8 flex items-center justify-between pt-4 border-t border-gray-200"},Zt={class:"text-xs text-gray-500"},Ut={class:"flex space-x-3"},zt=xe({__name:"BookingDetailsModal",props:{booking:{},userRole:{}},emits:["close","action"],setup(_){const f=_,V=B(()=>f.booking.status!=="cancelled"&&f.booking.status!=="completed"&&new Date(f.booking.scheduled_at)>new Date),Z=B(()=>(f.booking.status==="pending"||f.booking.status==="confirmed")&&new Date(f.booking.scheduled_at)>new Date(Date.now()+24*60*60*1e3)),Q=s=>({vendor_location:"Provider Location",customer_location:"Customer Location",online:"Online"})[s]||s,W=s=>({pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",in_progress:"bg-green-100 text-green-800",completed:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",k=s=>s.charAt(0).toUpperCase()+s.slice(1).replace("_"," "),U=s=>new Date(s).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),J=s=>new Date(s).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return(s,o)=>{var z,Y,S,R,P,E;return l(),a("div",Ue,[e("div",ze,[e("div",Ye,[e("div",Ee,[o[8]||(o[8]=e("h3",{class:"text-lg font-medium text-gray-900"}," Booking Details ",-1)),e("button",{onClick:o[0]||(o[0]=b=>s.$emit("close")),class:"text-gray-400 hover:text-gray-600 focus:outline-none focus:text-gray-600"},[c(d(L),{class:"h-6 w-6"})])]),e("div",Ie,[e("div",Oe,[e("div",He,[e("h4",qe,n((z=s.booking.service)==null?void 0:z.title),1),e("span",{class:N(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",W(s.booking.status)])},n(k(s.booking.status)),3)]),e("div",Ge,[e("div",null,[o[9]||(o[9]=e("span",{class:"text-gray-500"},"Booking Reference:",-1)),e("p",Qe,"#"+n(s.booking.booking_reference),1)]),e("div",null,[o[10]||(o[10]=e("span",{class:"text-gray-500"},"Total Amount:",-1)),e("p",We,"R"+n(s.booking.total_amount.toFixed(2)),1)]),e("div",null,[o[11]||(o[11]=e("span",{class:"text-gray-500"},"Payment Status:",-1)),e("p",Je,n(s.booking.payment_status),1)]),e("div",null,[o[12]||(o[12]=e("span",{class:"text-gray-500"},"Duration:",-1)),e("p",Ke,n(s.booking.duration_minutes)+" minutes",1)])])]),e("div",null,[o[13]||(o[13]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Schedule",-1)),e("div",Xe,[e("div",et,[c(d(se),{class:"h-5 w-5 text-blue-600"}),e("div",null,[e("p",tt,n(U(s.booking.scheduled_at)),1),e("p",st,n(J(s.booking.scheduled_at)),1)])]),e("div",ot,[c(d(pe),{class:"h-5 w-5 text-blue-600"}),e("p",nt,n(Q(s.booking.location_type)),1)])])]),e("div",null,[o[16]||(o[16]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Participants",-1)),e("div",rt,[e("div",it,[o[14]||(o[14]=e("h5",{class:"font-medium text-gray-900 mb-2"},"Customer",-1)),e("div",lt,[e("div",at,[c(d(ve),{class:"h-6 w-6 text-gray-600"})]),e("div",null,[e("p",dt,n((Y=s.booking.customer)==null?void 0:Y.name),1),e("p",ut,n((S=s.booking.customer)==null?void 0:S.email),1)])])]),e("div",ct,[o[15]||(o[15]=e("h5",{class:"font-medium text-gray-900 mb-2"},"Service Provider",-1)),e("div",mt,[e("div",gt,[c(d(ve),{class:"h-6 w-6 text-gray-600"})]),e("div",null,[e("p",pt,n((R=s.booking.vendor)==null?void 0:R.name),1),e("p",vt,n((P=s.booking.vendor)==null?void 0:P.email),1)])])])])]),s.booking.service?(l(),a("div",ft,[o[18]||(o[18]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Service Details",-1)),e("div",bt,[e("h5",xt,n(s.booking.service.title),1),e("p",yt,n(s.booking.service.short_description),1),e("div",ht,[e("span",null,"Category: "+n((E=s.booking.service.category)==null?void 0:E.name),1),o[17]||(o[17]=e("span",null,"â€¢",-1)),e("span",null,"Price: R"+n(s.booking.service.base_price),1)])])])):u("",!0),s.booking.customer_notes||s.booking.vendor_notes?(l(),a("div",wt,[o[21]||(o[21]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Notes",-1)),e("div",_t,[s.booking.customer_notes?(l(),a("div",kt,[o[19]||(o[19]=e("h5",{class:"text-sm font-medium text-yellow-800"},"Customer Notes",-1)),e("p",$t,n(s.booking.customer_notes),1)])):u("",!0),s.booking.vendor_notes?(l(),a("div",Ct,[o[20]||(o[20]=e("h5",{class:"text-sm font-medium text-blue-800"},"Provider Notes",-1)),e("p",Bt,n(s.booking.vendor_notes),1)])):u("",!0)])])):u("",!0),s.booking.service_address?(l(),a("div",Dt,[o[22]||(o[22]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Address",-1)),e("div",Mt,[e("div",St,[c(d(pe),{class:"h-5 w-5 text-gray-600 mt-0.5"}),e("div",null,[e("p",Rt,n(s.booking.service_address.address_line_1),1),s.booking.service_address.address_line_2?(l(),a("p",Pt,n(s.booking.service_address.address_line_2),1)):u("",!0),e("p",jt,n(s.booking.service_address.city)+", "+n(s.booking.service_address.province)+" "+n(s.booking.service_address.postal_code),1)])])])])):u("",!0),e("div",null,[o[27]||(o[27]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Payment Information",-1)),e("div",Tt,[e("div",Ft,[e("div",null,[o[23]||(o[23]=e("span",{class:"text-gray-500"},"Total Amount:",-1)),e("p",Lt,"R"+n(s.booking.total_amount.toFixed(2)),1)]),e("div",null,[o[24]||(o[24]=e("span",{class:"text-gray-500"},"Deposit:",-1)),e("p",Nt,"R"+n(s.booking.deposit_amount.toFixed(2)),1)]),e("div",null,[o[25]||(o[25]=e("span",{class:"text-gray-500"},"Payment Status:",-1)),e("p",{class:N(["font-medium capitalize",s.booking.payment_status==="paid"?"text-green-600":s.booking.payment_status==="partial"?"text-yellow-600":"text-red-600"])},n(s.booking.payment_status),3)]),e("div",null,[o[26]||(o[26]=e("span",{class:"text-gray-500"},"Currency:",-1)),e("p",At,n(s.booking.currency),1)])])])])]),e("div",Vt,[e("div",Zt," Created: "+n(U(s.booking.created_at)),1),e("div",Ut,[s.userRole==="customer"?(l(),a(A,{key:0},[Z.value?(l(),a("button",{key:0,onClick:o[1]||(o[1]=b=>s.$emit("action","reschedule",s.booking)),class:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[c(d(oe),{class:"w-4 h-4 mr-2"}),o[28]||(o[28]=p(" Reschedule "))])):u("",!0),V.value?(l(),a("button",{key:1,onClick:o[2]||(o[2]=b=>s.$emit("action","cancel",s.booking)),class:"inline-flex items-center px-4 py-2 border border-red-300 shadow-sm text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},[c(d(L),{class:"w-4 h-4 mr-2"}),o[29]||(o[29]=p(" Cancel Booking "))])):u("",!0)],64)):u("",!0),s.userRole==="vendor"?(l(),a(A,{key:1},[s.booking.status==="pending"?(l(),a("button",{key:0,onClick:o[3]||(o[3]=b=>s.$emit("action","confirm",s.booking)),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"},[c(d(ne),{class:"w-4 h-4 mr-2"}),o[30]||(o[30]=p(" Confirm "))])):u("",!0),s.booking.status==="confirmed"?(l(),a("button",{key:1,onClick:o[4]||(o[4]=b=>s.$emit("action","start",s.booking)),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[c(d(fe),{class:"w-4 h-4 mr-2"}),o[31]||(o[31]=p(" Start Service "))])):u("",!0),s.booking.status==="in_progress"?(l(),a("button",{key:2,onClick:o[5]||(o[5]=b=>s.$emit("action","complete",s.booking)),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500"},[c(d(be),{class:"w-4 h-4 mr-2"}),o[32]||(o[32]=p(" Complete "))])):u("",!0),V.value?(l(),a("button",{key:3,onClick:o[6]||(o[6]=b=>s.$emit("action","cancel",s.booking)),class:"inline-flex items-center px-4 py-2 border border-red-300 shadow-sm text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},[c(d(L),{class:"w-4 h-4 mr-2"}),o[33]||(o[33]=p(" Cancel "))])):u("",!0)],64)):u("",!0),e("button",{onClick:o[7]||(o[7]=b=>s.$emit("close")),class:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Close ")])])])])])}}}),Yt={key:0,class:"mb-6 flex items-center justify-end"},Et={class:"flex items-center space-x-2"},It={class:"bg-gray-100 p-1 rounded-lg flex"},Ot={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},Ht={class:"bg-white rounded-lg shadow p-6"},qt={class:"flex items-center"},Gt={class:"p-2 bg-blue-100 rounded-lg"},Qt={class:"ml-4"},Wt={class:"text-2xl font-bold text-gray-900"},Jt={class:"bg-white rounded-lg shadow p-6"},Kt={class:"flex items-center"},Xt={class:"p-2 bg-yellow-100 rounded-lg"},es={class:"ml-4"},ts={class:"text-2xl font-bold text-gray-900"},ss={class:"bg-white rounded-lg shadow p-6"},os={class:"flex items-center"},ns={class:"p-2 bg-green-100 rounded-lg"},rs={class:"ml-4"},is={class:"text-2xl font-bold text-gray-900"},ls={class:"bg-white rounded-lg shadow p-6"},as={class:"flex items-center"},ds={class:"p-2 bg-purple-100 rounded-lg"},us={class:"ml-4"},cs={class:"text-sm font-medium text-gray-500"},ms={class:"text-2xl font-bold text-gray-900"},gs={class:"bg-white rounded-lg shadow p-6 mb-8"},ps={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0"},vs={class:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4"},fs={class:"relative"},bs={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},xs={key:1,class:"flex justify-center items-center py-12"},ys={key:2,class:"text-center py-12"},hs={class:"mt-1 text-sm text-gray-500"},ws={class:"mt-6"},_s={key:3,class:"space-y-4"},ks={class:"p-6"},$s={class:"flex items-start justify-between"},Cs={class:"flex-1"},Bs={class:"flex items-center justify-between mb-4"},Ds={class:"flex items-center space-x-3"},Ms={class:"text-lg font-medium text-gray-900"},Ss={class:"text-right"},Rs={class:"text-sm text-gray-500"},Ps={class:"text-lg font-semibold text-gray-900"},js={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4"},Ts={class:"text-sm text-gray-500"},Fs={class:"text-sm font-medium text-gray-900"},Ls={class:"text-sm font-medium text-gray-900"},Ns={class:"text-sm text-gray-600"},As={class:"text-sm font-medium text-gray-900"},Vs={class:"text-sm font-medium text-gray-900"},Zs={key:0,class:"mb-4"},Us={key:0,class:"mb-2"},zs={class:"text-sm text-gray-700"},Ys={key:1},Es={class:"text-sm text-gray-700"},Is={class:"flex flex-wrap items-center gap-2"},Os=["onClick"],Hs=["onClick"],qs=["onClick"],Gs=["onClick"],Qs=["onClick"],Ws=["onClick"],Js=["onClick"],Ks={key:4,class:"mt-8"},Xs={class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6 rounded-lg shadow"},eo={class:"hidden sm:block"},to={class:"text-sm text-gray-700"},so={class:"font-medium"},oo={class:"font-medium"},no={class:"font-medium"},ro={class:"flex-1 flex justify-between sm:justify-end"},io=["disabled"],lo=["disabled"],xo=xe({__name:"bookings",setup(_){const{user:f}=Te(),{currentRole:V,setRole:Z,hasMultipleRoles:Q,initializeRole:W}=Fe(),{bookings:k,loading:U,fetchBookings:J,confirmBooking:s,markInProgress:o,completeBooking:z,rescheduleBooking:Y,getBookingStatus:S,formatBookingTime:R,canCancelBooking:P,canRescheduleBooking:E}=Le();Ne({title:"Bookings - ORDO Dashboard",meta:[{name:"description",content:"Manage your service bookings and appointments"}]});const b=C(""),I=C("all"),O=C(""),$=C(1),j=C(null),T=C(null),F=C(null),v=B(()=>{if(!f.value)return"customer";const i=f.value.roles||["customer"];return i.includes("vendor")&&i.includes("customer")?V.value:i.includes("vendor")?"vendor":"customer"}),ye=B(()=>Q.value),K=B(()=>{let i=[...k.value];if(b.value&&(i=i.filter(t=>t.status===b.value)),I.value!=="all"){const t=new Date,g=new Date(t.getFullYear(),t.getMonth(),t.getDate());i=i.filter(x=>{const m=new Date(x.scheduled_at);switch(I.value){case"today":return m>=g&&m<new Date(g.getTime()+24*60*60*1e3);case"week":const h=new Date(g.getTime()-g.getDay()*24*60*60*1e3),D=new Date(h.getTime()+7*24*60*60*1e3);return m>=h&&m<D;case"month":const r=new Date(g.getFullYear(),g.getMonth(),1),q=new Date(g.getFullYear(),g.getMonth()+1,1);return m>=r&&m<q;case"upcoming":return m>=t;default:return!0}})}if(O.value){const t=O.value.toLowerCase();i=i.filter(g=>{var x,m,h,D,r;return g.booking_reference.toLowerCase().includes(t)||((m=(x=g.service)==null?void 0:x.title)==null?void 0:m.toLowerCase().includes(t))||((r=v.value==="vendor"?(h=g.customer)==null?void 0:h.name:(D=g.vendor)==null?void 0:D.name)==null?void 0:r.toLowerCase().includes(t))})}return i}),H=B(()=>{const i=k.value.length,t=k.value.filter(m=>m.status==="pending").length,g=k.value.filter(m=>m.status==="completed").length,x=k.value.filter(m=>m.status==="completed").reduce((m,h)=>m+h.total_amount,0);return{total:i,pending:t,completed:g,revenue:x.toFixed(2)}}),y=B(()=>{const i=K.value.length,t=10,g=Math.ceil(i/t),x=($.value-1)*t,m=x+t;return{current_page:$.value,last_page:g,per_page:t,total:i,from:x+1,to:Math.min(m,i)}}),X=async()=>{$.value=1,await w()},w=async()=>{try{const i={type:v.value,per_page:50};b.value&&(i.status=b.value),await J(i)}catch(i){console.error("Failed to load bookings:",i)}},he=i=>({vendor_location:"Provider Location",customer_location:"Customer Location",online:"Online"})[i]||i,we=i=>{j.value=i},re=i=>{T.value=i},ee=i=>{F.value=i},ie=async i=>{try{await s(i.id),await w()}catch(t){console.error("Failed to confirm booking:",t)}},le=async i=>{try{await o(i.id),await w()}catch(t){console.error("Failed to start service:",t)}},ae=async i=>{try{await z(i.id),await w()}catch(t){console.error("Failed to complete booking:",t)}},_e=async(i,t)=>{try{await Y(i.id,t),T.value=null,await w()}catch(g){console.error("Failed to reschedule booking:",g)}},ke=async(i,t)=>{F.value=null,await w(),console.log("Booking cancelled successfully")},$e=async(i,t)=>{switch(i){case"confirm":await ie(t);break;case"start":await le(t);break;case"complete":await ae(t);break;case"cancel":ee(t);break;case"reschedule":re(t);break}j.value=null},Ce=()=>{$.value>1&&$.value--},Be=()=>{$.value<y.value.last_page&&$.value++};return Me(v,()=>{w()}),Se(()=>{W(),w()}),(i,t)=>{const g=De,x=zt,m=ce("RescheduleModal"),h=ce("CancelModal"),D=je;return l(),G(D,{name:"dashboard"},{default:me(()=>[e("div",null,[ye.value?(l(),a("div",Yt,[e("div",Et,[t[8]||(t[8]=e("span",{class:"text-sm text-gray-500"},"View as:",-1)),e("div",It,[e("button",{onClick:t[0]||(t[0]=r=>d(Z)("customer")),class:N(["px-3 py-1 text-sm font-medium rounded-md transition-colors",v.value==="customer"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"])}," Customer ",2),e("button",{onClick:t[1]||(t[1]=r=>d(Z)("vendor")),class:N(["px-3 py-1 text-sm font-medium rounded-md transition-colors",v.value==="vendor"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"])}," Provider ",2)])])])):u("",!0),e("div",Ot,[e("div",Ht,[e("div",qt,[e("div",Gt,[c(d(se),{class:"w-6 h-6 text-blue-600"})]),e("div",Qt,[t[9]||(t[9]=e("p",{class:"text-sm font-medium text-gray-500"},"Total Bookings",-1)),e("p",Wt,n(H.value.total),1)])])]),e("div",Jt,[e("div",Kt,[e("div",Xt,[c(d(oe),{class:"w-6 h-6 text-yellow-600"})]),e("div",es,[t[10]||(t[10]=e("p",{class:"text-sm font-medium text-gray-500"},"Pending",-1)),e("p",ts,n(H.value.pending),1)])])]),e("div",ss,[e("div",os,[e("div",ns,[c(d(ne),{class:"w-6 h-6 text-green-600"})]),e("div",rs,[t[11]||(t[11]=e("p",{class:"text-sm font-medium text-gray-500"},"Completed",-1)),e("p",is,n(H.value.completed),1)])])]),e("div",ls,[e("div",as,[e("div",ds,[c(d(Ae),{class:"w-6 h-6 text-purple-600"})]),e("div",us,[e("p",cs,n(v.value==="vendor"?"Revenue":"Spent"),1),e("p",ms,"R"+n(H.value.revenue),1)])])])]),e("div",gs,[e("div",ps,[e("div",vs,[te(e("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>b.value=r),onChange:X,class:"block w-full sm:w-auto px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},t[12]||(t[12]=[e("option",{value:""},"All Status",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"confirmed"},"Confirmed",-1),e("option",{value:"in_progress"},"In Progress",-1),e("option",{value:"completed"},"Completed",-1),e("option",{value:"cancelled"},"Cancelled",-1)]),544),[[ge,b.value]]),te(e("select",{"onUpdate:modelValue":t[3]||(t[3]=r=>I.value=r),onChange:X,class:"block w-full sm:w-auto px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},t[13]||(t[13]=[e("option",{value:"all"},"All Time",-1),e("option",{value:"today"},"Today",-1),e("option",{value:"week"},"This Week",-1),e("option",{value:"month"},"This Month",-1),e("option",{value:"upcoming"},"Upcoming",-1)]),544),[[ge,I.value]])]),e("div",fs,[te(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>O.value=r),onInput:X,type:"text",placeholder:"Search bookings...",class:"block w-full sm:w-64 pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},null,544),[[Re,O.value]]),e("div",bs,[c(d(Ze),{class:"h-5 w-5 text-gray-400"})])])])]),d(U)?(l(),a("div",xs,t[14]||(t[14]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1)]))):K.value.length===0?(l(),a("div",ys,[c(d(se),{class:"mx-auto h-12 w-12 text-gray-400"}),t[15]||(t[15]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No bookings found",-1)),e("p",hs,n(v.value==="vendor"?"Your services haven't been booked yet.":"You haven't made any bookings yet."),1),e("div",ws,[c(g,{to:v.value==="vendor"?"/dashboard/services":"/search",class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:me(()=>[p(n(v.value==="vendor"?"Create Service":"Browse Services"),1)]),_:1},8,["to"])])])):(l(),a("div",_s,[(l(!0),a(A,null,Pe(K.value,r=>{var q,de,ue;return l(),a("div",{key:r.id,class:"bg-white rounded-lg shadow hover:shadow-md transition-shadow duration-200"},[e("div",ks,[e("div",$s,[e("div",Cs,[e("div",Bs,[e("div",Ds,[e("h3",Ms,n(((q=r.service)==null?void 0:q.title)||"Service"),1),e("span",{class:N(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",d(S)(r).color])},n(d(S)(r).text),3)]),e("div",Ss,[e("p",Rs,"Booking #"+n(r.booking_reference),1),e("p",Ps," R"+n(r.total_amount.toFixed(2)),1)])]),e("div",js,[e("div",null,[e("p",Ts,n(v.value==="vendor"?"Customer":"Provider"),1),e("p",Fs,n(v.value==="vendor"?(de=r.customer)==null?void 0:de.name:(ue=r.vendor)==null?void 0:ue.name),1)]),e("div",null,[t[16]||(t[16]=e("p",{class:"text-sm text-gray-500"},"Date & Time",-1)),e("p",Ls,n(d(R)(r.scheduled_at).date),1),e("p",Ns,n(d(R)(r.scheduled_at).time),1)]),e("div",null,[t[17]||(t[17]=e("p",{class:"text-sm text-gray-500"},"Duration",-1)),e("p",As,n(r.duration_minutes)+" minutes ",1)]),e("div",null,[t[18]||(t[18]=e("p",{class:"text-sm text-gray-500"},"Location",-1)),e("p",Vs,n(he(r.location_type)),1)])]),r.customer_notes||r.vendor_notes?(l(),a("div",Zs,[r.customer_notes?(l(),a("div",Us,[t[19]||(t[19]=e("p",{class:"text-sm text-gray-500"},"Customer Notes:",-1)),e("p",zs,n(r.customer_notes),1)])):u("",!0),r.vendor_notes?(l(),a("div",Ys,[t[20]||(t[20]=e("p",{class:"text-sm text-gray-500"},"Provider Notes:",-1)),e("p",Es,n(r.vendor_notes),1)])):u("",!0)])):u("",!0),e("div",Is,[v.value==="customer"?(l(),a(A,{key:0},[d(E)(r)?(l(),a("button",{key:0,onClick:M=>re(r),class:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[c(d(oe),{class:"w-4 h-4 mr-1"}),t[21]||(t[21]=p(" Reschedule "))],8,Os)):u("",!0),d(P)(r)?(l(),a("button",{key:1,onClick:M=>ee(r),class:"inline-flex items-center px-3 py-1.5 border border-red-300 shadow-sm text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},[c(d(L),{class:"w-4 h-4 mr-1"}),t[22]||(t[22]=p(" Cancel "))],8,Hs)):u("",!0)],64)):u("",!0),v.value==="vendor"?(l(),a(A,{key:1},[r.status==="pending"?(l(),a("button",{key:0,onClick:M=>ie(r),class:"inline-flex items-center px-3 py-1.5 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"},[c(d(ne),{class:"w-4 h-4 mr-1"}),t[23]||(t[23]=p(" Confirm "))],8,qs)):u("",!0),r.status==="confirmed"?(l(),a("button",{key:1,onClick:M=>le(r),class:"inline-flex items-center px-3 py-1.5 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[c(d(fe),{class:"w-4 h-4 mr-1"}),t[24]||(t[24]=p(" Start Service "))],8,Gs)):u("",!0),r.status==="in_progress"?(l(),a("button",{key:2,onClick:M=>ae(r),class:"inline-flex items-center px-3 py-1.5 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500"},[c(d(be),{class:"w-4 h-4 mr-1"}),t[25]||(t[25]=p(" Complete "))],8,Qs)):u("",!0),d(P)(r)?(l(),a("button",{key:3,onClick:M=>ee(r),class:"inline-flex items-center px-3 py-1.5 border border-red-300 shadow-sm text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},[c(d(L),{class:"w-4 h-4 mr-1"}),t[26]||(t[26]=p(" Cancel "))],8,Ws)):u("",!0)],64)):u("",!0),e("button",{onClick:M=>we(r),class:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[c(d(Ve),{class:"w-4 h-4 mr-1"}),t[27]||(t[27]=p(" View Details "))],8,Js)])])])])])}),128))])),y.value.total>y.value.per_page?(l(),a("div",Ks,[e("nav",Xs,[e("div",eo,[e("p",to,[t[28]||(t[28]=p(" Showing ")),e("span",so,n(y.value.from),1),t[29]||(t[29]=p(" to ")),e("span",oo,n(y.value.to),1),t[30]||(t[30]=p(" of ")),e("span",no,n(y.value.total),1),t[31]||(t[31]=p(" results "))])]),e("div",ro,[e("button",{onClick:Ce,disabled:y.value.current_page<=1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,io),e("button",{onClick:Be,disabled:y.value.current_page>=y.value.last_page,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,lo)])])])):u("",!0),j.value?(l(),G(x,{key:5,booking:j.value,"user-role":v.value,onClose:t[5]||(t[5]=r=>j.value=null),onAction:$e},null,8,["booking","user-role"])):u("",!0),T.value?(l(),G(m,{key:6,booking:T.value,onClose:t[6]||(t[6]=r=>T.value=null),onReschedule:_e},null,8,["booking"])):u("",!0),F.value?(l(),G(h,{key:7,booking:F.value,"user-role":v.value,onClose:t[7]||(t[7]=r=>F.value=null),onCancel:ke},null,8,["booking","user-role"])):u("",!0)])]),_:1})}}});export{xo as default};
